<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Chapter 2. Pseudorandom Sequence Generators - shesl's blog</title><meta name=Description content="佘崧林同学的碎碎念博客"><meta property="og:title" content="Chapter 2. Pseudorandom Sequence Generators"><meta property="og:description" content="Background We focus on the deterministic algorithm: One is linear/non-linear feedback shift registers based on PRSGs. One relies on computation infeasible problems or other types of maths structure. Feedback Shift Register Sequence Feedback shift register (反馈位移寄存器), denotes as FSR： Introduction to FSR: feedback function $$a_{k+n} = f(a_k, a_{k+1}, \cdots, a_{k+n-1})$$ A state diagram of an FSR FSRs with"><meta property="og:type" content="article"><meta property="og:url" content="http://shesl-meow.github.io/note/%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%E8%AF%BE%E7%A8%8B/%E7%AE%97%E6%B3%95%E5%92%8C%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/2.prsg/"><meta property="og:image" content="http://shesl-meow.github.io/avatar.png"><meta property="article:section" content="note"><meta property="article:published_time" content="2019-03-27T12:06:27+08:00"><meta property="article:modified_time" content="2019-03-27T12:06:27+08:00"><meta property="og:site_name" content="shesl's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://shesl-meow.github.io/avatar.png"><meta name=twitter:title content="Chapter 2. Pseudorandom Sequence Generators"><meta name=twitter:description content="Background We focus on the deterministic algorithm: One is linear/non-linear feedback shift registers based on PRSGs. One relies on computation infeasible problems or other types of maths structure. Feedback Shift Register Sequence Feedback shift register (反馈位移寄存器), denotes as FSR： Introduction to FSR: feedback function $$a_{k+n} = f(a_k, a_{k+1}, \cdots, a_{k+n-1})$$ A state diagram of an FSR FSRs with"><meta name=application-name content="shesl's blog"><meta name=apple-mobile-web-app-title content="shesl's blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://shesl-meow.github.io/note/%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%E8%AF%BE%E7%A8%8B/%E7%AE%97%E6%B3%95%E5%92%8C%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/2.prsg/><link rel=prev href=http://shesl-meow.github.io/note/%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%E8%AF%BE%E7%A8%8B/%E7%AE%97%E6%B3%95%E5%92%8C%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/1.introduction/><link rel=next href=http://shesl-meow.github.io/note/%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%E8%AF%BE%E7%A8%8B/%E7%AE%97%E6%B3%95%E5%92%8C%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/4.block_hash_mac/><link rel=stylesheet href=/css/style.min.fa85115dce490a9d0bf009e2892b6d42439bdea75160d08cddcb0b97c8def676.css integrity="sha256-+oURXc5JCp0L8AniiSttQkOb3qdRYNCM3csLl8je9nY="><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Chapter 2. Pseudorandom Sequence Generators","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/shesl-meow.github.io\/note\/%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%E8%AF%BE%E7%A8%8B\/%E7%AE%97%E6%B3%95%E5%92%8C%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6\/2.prsg\/"},"genre":"note","keywords":"","wordcount":2021,"url":"http:\/\/shesl-meow.github.io\/note\/%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%E8%AF%BE%E7%A8%8B\/%E7%AE%97%E6%B3%95%E5%92%8C%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6\/2.prsg\/","datePublished":"2019-03-27T12:06:27+08:00","dateModified":"2019-03-27T12:06:27+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"佘崧林"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="shesl's blog">shesl-meow</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>博客 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/note/>笔记 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="shesl's blog">shesl-meow</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>博客</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/note/ title>笔记</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">Chapter 2. Pseudorandom Sequence Generators</h1><div class=content id=content><h2 id=background>Background</h2><p>We focus on the deterministic algorithm:</p><ol><li>One is linear/non-linear feedback shift registers based on <code>PRSGs</code>.</li><li>One relies on computation infeasible problems or other types of maths structure.</li></ol><h2 id=feedback-shift-register-sequence>Feedback Shift Register Sequence</h2><p>Feedback shift register (反馈位移寄存器), denotes as <code>FSR</code>：</p><ul><li><p>Introduction to <code>FSR</code>: feedback function $$a_{k+n} = f(a_k, a_{k+1}, \cdots, a_{k+n-1})$$</p></li><li><p>A state diagram of an <code>FSR</code></p></li><li><p><code>FSRs</code> with maximum periods:</p><ol><li>Maximum periods of an n-stage <code>FSR</code> sequence: $$2^n$$. Referred to as <strong>de Bruijn sequence</strong>.</li><li>Maximum periods of an n-stage <code>LFSR</code> sequence: $$2^n - 1$$. Referred to as <strong>m-sequence</strong>.</li></ol></li></ul><h2 id=lfsr-and-m-sequence><code>LFSR</code> and m-sequence</h2><h3 id=definition-and-properties>Definition and properties</h3><p>Definition (Characteristic polynomial):</p><ul><li>For feedback function: $$f(x_0, x_1, &mldr;, x_{n-1}) = c_{n-1}x_{n-1} +&mldr; +c_1x_1 + c_0 x_0$$</li><li>$$f(x) = x^n + c_{n-1}x^{n-1} +&mldr; +c_1x^1 + c_0 x^0$$ is called <strong>characteristic polynomial</strong></li></ul><p>Definition (Minimal polynomial):</p><ul><li>For a given sequence $${a_i} = {a_0, a_1, \cdots, a_{n-1}}$$</li><li>The characteristic polynomial with the smallest degree generating $${a_i}$$ is called <strong>minimal polynomial</strong></li></ul><p>Property:</p><ul><li>The minimal polynomial of an <code>LFSR</code> is a divisor of its characteristic polynomial.</li></ul><p>Property (m-sequence and its feedback polynomial):</p><ul><li>The period of the sequence $${a_i}$$ is equal to the period of its minimal polynomial.</li><li>So in order to design an m-sequence, we need to find a <strong>primitive polynomial</strong>.($$\deg f(x) = n$$)</li></ul><p>Property:</p><ul><li>All m-sequences generated by the same <code>LFSR</code> are <strong>shift equivalent</strong>.</li></ul><p>Common equations:</p><ul><li>$$\displaystyle \underbrace{0, \cdots, 0}_{n-1},1 \Rightarrow f(x) = x^n + 1$$</li><li>$$\displaystyle \underbrace{1, \cdots, 1}_{n-1}, 0 \Rightarrow f(x) = x^{n-1}(x+1) + 1$$</li></ul><h3 id=linear-span-and-bm-algorithm>Linear span and BM algorithm</h3><p>Definition (linear span):</p><ul><li><p>For a given sequence $${a_i} = {a_0, a_1, \cdots, a_{n-1}}$$</p></li><li><p>We define the degree of the minimal polynomial of <code>a</code> as <strong>linear span (linear complexity)</strong> of <code>a</code>, denotes as <strong>LS(a)</strong>. <code>Berlekamp-Massey</code> algorithm can be used to calculate <code>LS(a)</code></p></li></ul><p>Property:</p><ul><li>For a given sequence $${a_i} = {a_0, a_1, \cdots, a_{n-1}}$$, linear span of first <code>N</code> bit denotes as $$L_N$$</li><li>Then we have: $$L_{N+1} = L_N \or (N+1-L_N)$$</li></ul><p>Definition (<strong>Discrepancy sequences</strong>):</p><ul><li>For a given sequence $$a^N = a_0, a_1, \cdots, a_{N-1}$$</li><li>Let $$\displaystyle f(x) = x^l + \sum_{i=0}^{l-1}c_ix^i$$ be the minimal polynomial of <code>LFSR</code>.</li><li>Let $$\displaystyle v_k = a_{l+k} + \sum_{i = 0}^{l - 1} c_i a_{i+k}, k = 0,1, \cdots, N-l-1$$</li><li>$${V_k}$$ is called <strong>discrepancy sequence</strong> associated with <code>f(x)</code> and $$a^N$$</li></ul><p>Lemma:</p><ul><li>Assume that $$f_{n-1}(x)$$ is the characteristic polynomial of the shortest <code>LFSR</code> generating $$a_0, a_1, \cdots, a_{n-1}$$, but not $$a_0, a_1, \cdots, a_{n}, n &lt; N$$. In the other word (Assuming $$LS(f(x)) = l_{n-1}$$):<ul><li>For $$k=0,1,\cdots, n-1-l_{n-1}$$, we have $$\displaystyle a_{l_{n-1}+k} = \sum_{i=0}^{l_{n-1}-1}a_{i+k} \Rightarrow v_k = 0$$</li><li>But for $$k = n - l_{n-1} \Rightarrow v_k = 1$$</li></ul></li><li>Consider discrepancy sequences: $$\displaystyle (v_0, v_1, \cdots, v_{n - l_{n-1}}) = (\underbrace{0, \cdots,0}<em>{n - l</em>{n-1}}, 1)$$</li><li>How to obtain $$f_n$$ from the previous $$f_i, i &lt; n$$?<ol><li>Find the nearest <code>LFSR</code> such that $$l_{m-1} &lt; l_{m} = \cdots = l_{n-1}$$</li><li>Assuming $$a = m - l_{m-1}, b = n - l_{n-1}$$,</li><li>we can obtain f: $$f_n(x) = \begin{cases} f_{n-1} + x^d f_{m-1}, & d = a - b, a > b \ x^d f_{n-1} + f_{m-1}, & d = b - a, a \le b\end{cases}$$</li></ol></li></ul><p>Algorithm (<code>Berlekamp-Massey</code>) python code (it seems couldn&rsquo;t run):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python2.7</span>
</span></span><span class=line><span class=cl><span class=c1># coding=utf-8</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BMSolution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>capturedSequence</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>var</span><span class=p>(</span><span class=s2>&#34;x&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>Z</span> <span class=o>=</span> <span class=n>GF</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>capturedSequence</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>Z</span><span class=p>(</span><span class=n>bit</span><span class=p>)</span> <span class=k>for</span> <span class=n>bit</span> <span class=ow>in</span> <span class=n>capturedSequence</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>rawSequence</span> <span class=o>=</span> <span class=n>capturedSequence</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>initializePolynomial</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>initializePolynomial</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>k</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>rawSequence</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1># 第一个 1 bit</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>**</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span> <span class=c1># f(x), 当前的最小多项式</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>m</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># 前一个多项式所在的最后的位置</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>prevMinPolynomial</span> <span class=o>=</span> <span class=mi>1</span> <span class=c1># g(x), 之前的一个最小多项式</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>solvePolynomial</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>k</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>rawSequence</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=n>l</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span><span class=o>.</span><span class=n>degree</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>d</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>([</span><span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span><span class=o>.</span><span class=n>coefficient</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>rawSequence</span><span class=p>[</span><span class=n>n</span> <span class=o>-</span> <span class=n>l</span> <span class=o>+</span> <span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>l</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)])</span> <span class=o>%</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>d</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span> <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>m</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>prevMinPolynomial</span><span class=o>.</span><span class=n>degree</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span><span class=o>.</span><span class=n>degree</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=mi>2</span><span class=o>*</span><span class=n>l</span> <span class=o>&gt;</span> <span class=n>n</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>**</span> <span class=p>(</span><span class=n>a</span> <span class=o>-</span> <span class=n>b</span><span class=p>)</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>prevMinPolynomial</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>prevMinPolynomial</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>**</span> <span class=p>(</span><span class=n>b</span> <span class=o>-</span> <span class=n>a</span><span class=p>)</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>prevMinPolynomial</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>prevMinPolynomial</span> <span class=o>=</span> <span class=n>prevMinPolynomial</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>minimalPolynomial</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>sp</span> <span class=o>=</span> <span class=n>BMSolution</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>sp</span><span class=o>.</span><span class=n>solvePolynomial</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p><em>PostScript</em>: 可以直接在 <code>sagemath</code> 中使用下面的方式求解：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>berlekamp_massey</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>])</span> <span class=c1># x^2 - 1</span>
</span></span></code></pre></td></tr></table></div></div><p>Property:</p><ul><li>If <code>2n</code> (<code>n</code> is the linear span) bits are known in an <code>N</code> bits long sequence, we can recover the rest of bits.</li></ul><h3 id=correlation-function>Correlation function</h3><p>Goal:</p><ul><li>Correlation function measure the similarity one sequence with a shift of the other.</li></ul><p>Definition (when periods are the same <code>N</code>):</p><ul><li>$$\displaystyle C_{a, b}(\tau) = \sum_{i = 0}^{N - 1} (-1)^{a_i + b_i + \tau}$$</li><li>It&rsquo;s equal to the difference between the number of the agreements and that of disagreements of <code>a</code> with the shift <code>t</code>.</li></ul><p>Definition (when period are different <code>N</code> and <code>M</code>):</p><ul><li>Assume $$T = lcm(N, M)$$, $$\displaystyle C_{(a^T, b)} (\tau) = \sum_{i = 0}^{T - 1} (-1)^{a_i + b_i +\tau}$$</li></ul><h2 id=randomness>Randomness</h2><h3 id=golombs-randomness-postulates>Golomb&rsquo;s Randomness Postulates</h3><p>R-1 Blance property:</p><ul><li>0 and 1 has the same possibility</li></ul><p>R-2 run property:</p><ul><li>A periodic sequence is said to have the run property if in every period of the sequence, there are $$2^k$$ runs of length n-k where $$n = logN, 1 \le k \lt n$$. Moreover, for each of these lengths, there are equally many runs of 0&rsquo;s and of 1&rsquo;s.</li></ul><p>R-3 Idea 2-level autocorrelation:</p><h3 id=randomness-criteria>Randomness Criteria</h3><ol><li>Large period</li><li>Statistics properties:<ol><li>Balanced property: each element occurs nearly equally many times;</li><li>Run property R2;</li><li>(ideal) <code>k-tuple</code> distribution; Each non-zero k-tuple occurs exactly one.</li></ol></li><li>Correlation:<ol><li>2-level autocorrelation</li><li>Low crosscorrelation</li></ol></li><li>Large linear span (complexity). $$\displaystyle \frac{tN}{2} \le LS(a) \le N, \text{where t is constant}, 0 \lt t \le 1$$</li><li>Indistinguishability.</li></ol><h2 id=generators>Generators</h2><ol><li>Non-linear generator</li><li>Filtering sequence generator</li><li>Combination sequence generator</li><li>Select boolean generator</li><li>Clock control & shrink generator</li><li>Stop and go generator</li><li>Shrink generator</li></ol><h2 id=one-time-pad>One-Time Pad</h2><p><img class=lazyload src=/svg/loading.min.svg data-src=../OneTimePad.png data-srcset="../OneTimePad.png, ../OneTimePad.png 1.5x, ../OneTimePad.png 2x" data-sizes=auto alt=../OneTimePad.png title=./OneTimePad.png></p><h2 id=known-attack>Known Attack</h2><h3 id=correlation-attack>Correlation attack</h3><p>A naive way to conduct an attack is to do an <strong>exhaustive search</strong> for the entire space for a possible internal state, then the search complexity is given by: $$\displaystyle T_0 = \prod_{i=0}^{m-1} 2^{n_i}$$</p><p>If we can decompose the <code>PRSG</code> into m sub-generators, those m sub-generators are filtered by a boolean function <code>h</code>: $$Z = h(X_0, X_1, \cdots, X_{m-1})$$.</p><p>We now look at whether the output random variable Z and input variable $$X_i$$ are correlated. Using this fact, the search complexity can be tremendously reduced to approximately:</p><ul><li>$$\displaystyle T_1 = \sum_{i \in I_c} 2^{n_i} + \prod_{i \in I_{uc}}2^{n_i}$$</li><li>where $$\begin{cases}I_c = {i | 0 \le i &lt; m,& Z\text{ and }X_i\text{ are correlated}} \ I_{uc} = {i | 0 \le i &lt; m,& Z\text{ and }X_i\text{ are uncorrelated}} \end{cases}$$</li></ul><h1 id=课堂笔记>课堂笔记</h1><h2 id=有限域>有限域</h2><p>需要一个随机性、算法速度兼顾的算法。</p><p>所以我们考虑以下的运算：异或、移位、加减法、布尔函数&mldr;</p><p>定义（Finite Field）：记作 $$\mathbb{F}_n$$</p><ul><li>对于 <code>+</code> 运算：存在 <code>0</code> 元；对于任意元素，存在一个其加法运算的负元。</li><li>对于 <code>*</code> 运算：存在 <code>1</code> 元；对于任意元素，存在一个其乘法的逆元。</li></ul><p>定理：</p><ul><li><p>对于 p 是素数，$$\mathbb{Z}_p = \mathbb{F}_p$$</p></li><li><p>Expansion：$$\displaystyle \mathbb{F}<em>p \Rightarrow \mathbb{F}</em>{p^n}$$</p></li></ul><p>如何从 $$\mathbb{F}<em>2$$ 构造 $$\mathbb{F}</em>{2^n}$$：</p><ul><li><p>令 $$GF(2^n) = {x_0 + x_1 \alpha + &mldr; + x_{n-1} \alpha^{n-1}\text{, where } x_i \in \mathbb{F_2}}$$</p></li><li><p>那么我们可以构造：$$\displaystyle \mathbb{F}_4 = \frac{GF(2)<i class="far fa-check-square fa-fw" aria-hidden=true></i> }{p(x)}\text{, where }\deg{p(x)} = n, p(x):irreducible$$</p></li></ul><p>表示方法：</p><ul><li>polynomial representation:$$x_0 + x_1\alpha + x_2 \alpha^2 +&mldr; + x_{n-1}\alpha^{n-1}$$</li><li>vector based representation:$$(x_0, x_1,&mldr;, x_{n-1})$$</li><li>Exponential representation:$${\alpha^i, i = 0,1,&mldr;,2^{n}-2}$$</li></ul><p>定义（Multiplicative Group）：</p><ul><li>$$\displaystyle GF(2^n)^{*} = GF(2^n)\text{\}{0} = {\alpha^i, i = 0,1,&mldr;,2^{n}-2}$$</li></ul><h2 id=group>Group</h2><p>定义：</p><ol><li><p>Associative: $$a * (b<em>c) = (a</em>b)*c$$</p></li><li><p>Identity: $$\exist e \in G, a<em>e = e</em>a = a$$</p></li><li><p>$$\forall a \in G, \exist a^{-1}, \text{so that }a * a^{-1} = e$$</p></li><li><p>$$\text{For }a, b \in G, a<em>b = b</em>a \Rightarrow$$ Commutative Group 交换群</p></li></ol><h2 id=primitive>Primitive</h2><p>定义：考虑在 $$GF(2^n)^*$$ 中：</p><ul><li><p>$$ord \beta$$: the least integer m such that $$\beta^m = 1$$</p></li><li><p>primitive: We say $$\beta$$ is primitive if $$ord \beta = 2^n - 1$$</p></li></ul><p>定理：</p><ul><li><p>$$\alpha$$ is a root of $$f(x)$$, then $$\alpha^{2^i}, i = 0,1,&mldr;,n-1$$ are root of $$f(x)$$</p></li><li><p>$$\displaystyle ord \alpha^s = \frac{ord \alpha}{gcd(s, ord \alpha)}$$</p></li></ul><h2 id=feedback-shift-register-sequences>Feedback Shift Register Sequences</h2><h3 id=maximum-periods>Maximum Periods</h3><p>我们发现：</p><ul><li>Output bits are closely related to <code>feedback function</code>, and <code>internal states</code></li></ul><h3 id=m-sequence>m-sequence</h3><p>性质：</p><ul><li><p>定义操作符 L：$$(a_0, a_1, &mldr;, a_{n-1}) \rightarrow (a_1, a_2, &mldr;, a_n)$$</p></li><li><p>对于特征多项式，我们总有：$$\displaystyle f(L)*\overset{\rightarrow}{a} = 0$$</p></li></ul><p>性质：</p><ul><li>如果 f(x), g(x) 是特征多项式，我们有：$$f(x) + g(x), x^i *f(x), h(x) * f(x)$$ 也是特征多项式</li></ul><p>有 Caylor-Hamilton Theorem：</p><ul><li><p>对于 FSRS 的转移矩阵 M，</p></li><li><p>If $$f(x) | x^r -1 \Rightarrow M^r = I \Rightarrow$$ Internal state repeats at the period <code>r</code></p></li></ul><p>定义：</p><ul><li>如果我们连个 LFSR 通过同一个转移函数得到，则我们称他们为 <code>shift equivalent</code></li></ul><h3 id=linear-span>linear span</h3><p>定义：</p><ul><li>An LFSR s said to generate a finite sequence $$a_0, a_1, &mldr;, a_{N-1}$$ when the this sequence conincides with the first N output elements of l-stage LFSR for the initial state $$(a_0, a_1,&mldr;,a_{l-1})$$. The shortest length of the LFSR which generate $$a^N$$ is called the linear span of $$a^N$$.</li></ul><h3 id=discrepancy-sequences>Discrepancy Sequences</h3><p>对于一个给定的序列，<code>Discrepancy Sequences</code> 是一个构造生成给定序列的 LFSR 的方法。</p><p>因为特殊的我们有：$$00\dots001 \Rightarrow f(x) = x^n +1$$</p><p>我们又知道 $$\displaystyle f_n(x) \begin{cases}f_{n-1} + x^d f_{m-1}, d = a-b,\text{if }a>b \ x^df_{n-1} + f_{m-1}, d = b-a, \text{if }a \le b \end{cases}$$</p><h3 id=correlation-functions-of-sequences>Correlation Functions of Sequences</h3><p>Mesure the similarity of one sequence with a shift of the other.</p><p>Define the two sequences correlation function with the same period N: $$\displaystyle C_{a,b}(\tau) = \sum_{i = 0}^{N-1} (-1)^{a_i + b_i + \tau}$$</p><p>$$C_a(t)$$ measures the <strong>similarity</strong> between the sequence and its shift, euqal to the difference between the number of the agreements and that of disagreements of a with the shift t.</p><p>Defined for two sequences a and b with their respective lengths N and M: $$\displaystyle C_{a^T, b} (\tau) \sum_{i = 0}^{T-1} (-1)^{a_i + b_i + \tau}, \tau = 0,1,\dots, T = lcm(N, M)$$</p></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://shesl-meow.github.io target=_blank>佘崧林</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/copy-tex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/valine@1.4.18/dist/Valine.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.0/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:50},comment:{valine:{appId:"zDVJohJIQbD6f3W267xtaYRC-gzGzoHsz",appKey:"ewsfU9ocNOeuvt0MzONe6yKx",avatar:"mp",el:"#valine",emojiCDN:"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/",emojiMaps:{100:"1f4af.png",alien:"1f47d.png",anger:"1f4a2.png",angry:"1f620.png",anguished:"1f627.png",astonished:"1f632.png",black_heart:"1f5a4.png",blue_heart:"1f499.png",blush:"1f60a.png",bomb:"1f4a3.png",boom:"1f4a5.png",broken_heart:"1f494.png",brown_heart:"1f90e.png",clown_face:"1f921.png",cold_face:"1f976.png",cold_sweat:"1f630.png",confounded:"1f616.png",confused:"1f615.png",cry:"1f622.png",crying_cat_face:"1f63f.png",cupid:"1f498.png",dash:"1f4a8.png",disappointed:"1f61e.png",disappointed_relieved:"1f625.png",dizzy:"1f4ab.png",dizzy_face:"1f635.png",drooling_face:"1f924.png",exploding_head:"1f92f.png",expressionless:"1f611.png",face_vomiting:"1f92e.png",face_with_cowboy_hat:"1f920.png",face_with_hand_over_mouth:"1f92d.png",face_with_head_bandage:"1f915.png",face_with_monocle:"1f9d0.png",face_with_raised_eyebrow:"1f928.png",face_with_rolling_eyes:"1f644.png",face_with_symbols_on_mouth:"1f92c.png",face_with_thermometer:"1f912.png",fearful:"1f628.png",flushed:"1f633.png",frowning:"1f626.png",ghost:"1f47b.png",gift_heart:"1f49d.png",green_heart:"1f49a.png",grimacing:"1f62c.png",grin:"1f601.png",grinning:"1f600.png",hankey:"1f4a9.png",hear_no_evil:"1f649.png",heart:"2764-fe0f.png",heart_decoration:"1f49f.png",heart_eyes:"1f60d.png",heart_eyes_cat:"1f63b.png",heartbeat:"1f493.png",heartpulse:"1f497.png",heavy_heart_exclamation_mark_ornament:"2763-fe0f.png",hole:"1f573-fe0f.png",hot_face:"1f975.png",hugging_face:"1f917.png",hushed:"1f62f.png",imp:"1f47f.png",innocent:"1f607.png",japanese_goblin:"1f47a.png",japanese_ogre:"1f479.png",joy:"1f602.png",joy_cat:"1f639.png",kiss:"1f48b.png",kissing:"1f617.png",kissing_cat:"1f63d.png",kissing_closed_eyes:"1f61a.png",kissing_heart:"1f618.png",kissing_smiling_eyes:"1f619.png",laughing:"1f606.png",left_speech_bubble:"1f5e8-fe0f.png",love_letter:"1f48c.png",lying_face:"1f925.png",mask:"1f637.png",money_mouth_face:"1f911.png",nauseated_face:"1f922.png",nerd_face:"1f913.png",neutral_face:"1f610.png",no_mouth:"1f636.png",open_mouth:"1f62e.png",orange_heart:"1f9e1.png",partying_face:"1f973.png",pensive:"1f614.png",persevere:"1f623.png",pleading_face:"1f97a.png",pouting_cat:"1f63e.png",purple_heart:"1f49c.png",rage:"1f621.png",relaxed:"263a-fe0f.png",relieved:"1f60c.png",revolving_hearts:"1f49e.png",right_anger_bubble:"1f5ef-fe0f.png",robot_face:"1f916.png",rolling_on_the_floor_laughing:"1f923.png",scream:"1f631.png",scream_cat:"1f640.png",see_no_evil:"1f648.png",shushing_face:"1f92b.png",skull:"1f480.png",skull_and_crossbones:"2620-fe0f.png",sleeping:"1f634.png",sleepy:"1f62a.png",slightly_frowning_face:"1f641.png",slightly_smiling_face:"1f642.png",smile:"1f604.png",smile_cat:"1f638.png",smiley:"1f603.png",smiley_cat:"1f63a.png",smiling_face_with_3_hearts:"1f970.png",smiling_imp:"1f608.png",smirk:"1f60f.png",smirk_cat:"1f63c.png",sneezing_face:"1f927.png",sob:"1f62d.png",space_invader:"1f47e.png",sparkling_heart:"1f496.png",speak_no_evil:"1f64a.png",speech_balloon:"1f4ac.png","star-struck":"1f929.png",stuck_out_tongue:"1f61b.png",stuck_out_tongue_closed_eyes:"1f61d.png",stuck_out_tongue_winking_eye:"1f61c.png",sunglasses:"1f60e.png",sweat:"1f613.png",sweat_drops:"1f4a6.png",sweat_smile:"1f605.png",thinking_face:"1f914.png",thought_balloon:"1f4ad.png",tired_face:"1f62b.png",triumph:"1f624.png",two_hearts:"1f495.png",unamused:"1f612.png",upside_down_face:"1f643.png",weary:"1f629.png",white_frowning_face:"2639-fe0f.png",white_heart:"1f90d.png",wink:"1f609.png",woozy_face:"1f974.png",worried:"1f61f.png",yawning_face:"1f971.png",yellow_heart:"1f49b.png",yum:"1f60b.png",zany_face:"1f92a.png",zipper_mouth_face:"1f910.png",zzz:"1f4a4.png"},enableQQ:!1,highlight:!0,lang:"zh-CN",pageSize:10,placeholder:"你的评论 ...",recordIP:!0,serverURLs:"https://zdvjohji.lc-cn-n1-shared.com",visitor:!0}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"",algoliaIndex:"",algoliaSearchKey:"",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.c1d5acc03abc8af9ee0a42aa4e942566a338a3e29d21b6c9f11536101f6914ad.js integrity="sha256-wdWswDq8ivnuCkKqTpQlZqM4o+KdIbbJ8RU2EB9pFK0="></script></body></html>