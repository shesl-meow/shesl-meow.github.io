<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>:speech_balloon:ç”¨ ReactTsx è¯­æ³•å‘é€é£ä¹¦äº¤äº’å¡ç‰‡ - shesl's blog</title><meta name=Description content="ä½˜å´§æ—åŒå­¦çš„ç¢ç¢å¿µåšå®¢"><meta property="og:title" content=":speech_balloon:ç”¨ ReactTsx è¯­æ³•å‘é€é£ä¹¦äº¤äº’å¡ç‰‡">
<meta property="og:description" content="æœ¬æ–‡æœ‰åŒæ­¥åˆ°æ˜é‡‘ï¼šhttps://juejin.cn/post/7129942982760857613 æœ€ç»ˆæ•ˆæœ Demo èƒŒæ™¯ é£ä¹¦å¡ç‰‡æ˜¯ä¸€ä¸ªåŠŸèƒ½éå¸¸ä¸°"><meta property="og:type" content="article"><meta property="og:url" content="http://shesl-meow.github.io/posts/%E7%94%A8-reacttsx-%E8%AF%AD%E6%B3%95%E5%8F%91%E9%80%81%E9%A3%9E%E4%B9%A6%E4%BA%A4%E4%BA%92%E5%8D%A1%E7%89%87/"><meta property="og:image" content="http://shesl-meow.github.io/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-07T13:49:44+08:00"><meta property="article:modified_time" content="2022-01-07T13:49:44+08:00"><meta property="og:site_name" content="shesl's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://shesl-meow.github.io/avatar.png"><meta name=twitter:title content=":speech_balloon:ç”¨ ReactTsx è¯­æ³•å‘é€é£ä¹¦äº¤äº’å¡ç‰‡"><meta name=twitter:description content="æœ¬æ–‡æœ‰åŒæ­¥åˆ°æ˜é‡‘ï¼šhttps://juejin.cn/post/7129942982760857613 æœ€ç»ˆæ•ˆæœ Demo èƒŒæ™¯ é£ä¹¦å¡ç‰‡æ˜¯ä¸€ä¸ªåŠŸèƒ½éå¸¸ä¸°"><meta name=application-name content="shesl's blog"><meta name=apple-mobile-web-app-title content="shesl's blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://shesl-meow.github.io/posts/%E7%94%A8-reacttsx-%E8%AF%AD%E6%B3%95%E5%8F%91%E9%80%81%E9%A3%9E%E4%B9%A6%E4%BA%A4%E4%BA%92%E5%8D%A1%E7%89%87/><link rel=prev href=http://shesl-meow.github.io/posts/%E6%96%87%E6%A1%A3%E6%95%B0%E6%8D%AE%E5%BA%93-mongodb-%E5%8E%9F%E7%90%86%E6%B5%85%E6%9E%90/><link rel=next href=http://shesl-meow.github.io/posts/c++-coredump-%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/><link rel=stylesheet href=/css/style.min.f9dcece0006720752966c5ab2d548675424bb8b985943a9e2d120f7b736cf8eb.css integrity="sha256-+dzs4ABnIHUpZsWrLVSGdUJLuLmFlDqeLRIPe3Ns+Os="><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":":speech_balloon:ç”¨ ReactTsx è¯­æ³•å‘é€é£ä¹¦äº¤äº’å¡ç‰‡","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/shesl-meow.github.io\/posts\/%E7%94%A8-reacttsx-%E8%AF%AD%E6%B3%95%E5%8F%91%E9%80%81%E9%A3%9E%E4%B9%A6%E4%BA%A4%E4%BA%92%E5%8D%A1%E7%89%87\/"},"genre":"posts","keywords":"å‰ç«¯, æœåŠ¡ç«¯, TypeScript, å­—èŠ‚è·³åŠ¨","wordcount":1974,"url":"http:\/\/shesl-meow.github.io\/posts\/%E7%94%A8-reacttsx-%E8%AF%AD%E6%B3%95%E5%8F%91%E9%80%81%E9%A3%9E%E4%B9%A6%E4%BA%A4%E4%BA%92%E5%8D%A1%E7%89%87\/","datePublished":"2022-01-07T13:49:44+08:00","dateModified":"2022-01-07T13:49:44+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"ä½˜å´§æ—"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><script src=https://unpkg.com/vue@2></script><div class=header-wrapper><div class=header-title><a href=/ title="shesl's blog">shesl-meow</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>åšå®¢
</a><a class=menu-item href=/tags/>æ ‡ç­¾
</a><a class=menu-item href=/categories/>åˆ†ç±»
</a><a class=menu-item href=/note/>ç¬”è®°</a><div class=dropdown><a class="menu-item menu-more dropbtn" title href=javascript:void(0);>æ¸¸æˆ</a><div class="menu-more-content dropdown-content"><a href=/games/2048/ title><i class='fa-solid fa-puzzle-piece'></i> 2048 </a><a href=/games/schulte/ title><i class='fa-solid fa-chess-board'></i> Schulte</a></div></div><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=æœç´¢><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=æ¸…ç©º><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="shesl's blog">shesl-meow</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=æœç´¢><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=æ¸…ç©º><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>å–æ¶ˆ</a></div><a class=menu-item href=/posts/>åšå®¢
</a><a class=menu-item href=/tags/>æ ‡ç­¾
</a><a class=menu-item href=/categories/>åˆ†ç±»
</a><a class=menu-item href=/note/>ç¬”è®°</a><div class=dropdown><a class="menu-item menu-more dropbtn" title href=javascript:void(0);>æ¸¸æˆ</a><div class="menu-more-content dropdown-content"><a href=/games/2048/ title><i class='fa-solid fa-puzzle-piece'></i> 2048 </a><a href=/games/schulte/ title><i class='fa-solid fa-chess-board'></i> Schulte</a></div></div><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>ç›®å½•</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ğŸ’¬ç”¨ ReactTsx è¯­æ³•å‘é€é£ä¹¦äº¤äº’å¡ç‰‡</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://shesl-meow.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>ä½˜å´§æ—</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-01-07>2022-01-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;çº¦ 1974 å­—&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;é¢„è®¡é˜…è¯» 4 åˆ†é’Ÿ&nbsp;<span id=/posts/%E7%94%A8-reacttsx-%E8%AF%AD%E6%B3%95%E5%8F%91%E9%80%81%E9%A3%9E%E4%B9%A6%E4%BA%A4%E4%BA%92%E5%8D%A1%E7%89%87/ class=leancloud_visitors data-flag-title=":speech_balloon:ç”¨ ReactTsx è¯­æ³•å‘é€é£ä¹¦äº¤äº’å¡ç‰‡">
<i class="far fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;æ¬¡é˜…è¯»
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>ç›®å½•</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#æœ€ç»ˆæ•ˆæœ-demo>æœ€ç»ˆæ•ˆæœ Demo</a></li><li><a href=#èƒŒæ™¯>èƒŒæ™¯</a></li><li><a href=#æ€»ä½“ç³»ç»Ÿè®¾è®¡>æ€»ä½“ç³»ç»Ÿè®¾è®¡</a></li><li><a href=#sdk-ç³»ç»Ÿå®ç°>SDK ç³»ç»Ÿå®ç°</a><ul><li><a href=#tsx-ä»£ç ç¼–è¯‘>Tsx ä»£ç ç¼–è¯‘</a></li><li><a href=#é‡æ–°é€ ä¸€ä¸ª-react-çš„è½®å­>é‡æ–°é€ ä¸€ä¸ª React çš„è½®å­</a></li><li><a href=#ä¸åŒå½¢çŠ¶çš„è½®å­>ä¸åŒå½¢çŠ¶çš„è½®å­</a></li></ul></li><li><a href=#runtime-ç³»ç»Ÿå®ç°>Runtime ç³»ç»Ÿå®ç°</a><ul><li><a href=#æ— çŠ¶æ€æœåŠ¡æ¨¡å‹>æ— çŠ¶æ€æœåŠ¡æ¨¡å‹</a></li><li><a href=#æœ‰çŠ¶æ€æœåŠ¡æ¨¡å‹>æœ‰çŠ¶æ€æœåŠ¡æ¨¡å‹</a></li></ul></li><li><a href=#é—ç•™çš„é—®é¢˜>é—ç•™çš„é—®é¢˜</a></li></ul></nav></div></div><div class=content id=content><blockquote><p>æœ¬æ–‡æœ‰åŒæ­¥åˆ°æ˜é‡‘ï¼šhttps://juejin.cn/post/7129942982760857613</p></blockquote><h2 id=æœ€ç»ˆæ•ˆæœ-demo>æœ€ç»ˆæ•ˆæœ Demo</h2><h2 id=èƒŒæ™¯>èƒŒæ™¯</h2><p>é£ä¹¦å¡ç‰‡æ˜¯ä¸€ä¸ªåŠŸèƒ½éå¸¸ä¸°å¯Œçš„ç»„ä»¶ï¼Œå¯¹äºå¸Œæœ›æ„å»ºç²¾ç¾çš„çº¯æ ·å¼æˆ–è€…ç®€å•è·³è½¬æŒ‰é’®çš„å¡ç‰‡ï¼Œé£ä¹¦æä¾›äº†è§£å†³æ–¹æ¡ˆï¼š<a href=https://bytedance.feishu.cn/wiki/V4mPw7nkUiZySSkyok2cUinjnIh target=_blank rel="noopener noreffer">å¦‚ä½•å¿«é€Ÿæ­å»ºç²¾ç¾çš„æ¶ˆæ¯å¡ç‰‡ï¼Ÿ</a></p><p>ä½†æ˜¯æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›å‘é€çš„é£ä¹¦å¡ç‰‡ï¼šå†…å®¹åŠ¨æ€åŒ–åœ°æ ¹æ®ç½‘ç»œè¯·æ±‚ã€é…ç½®ã€çŠ¶æ€ç­‰ä¿¡æ¯æ¸²æŸ“ã€‚
åŒæ—¶åˆå¸Œæœ›å®ƒæ‹¥æœ‰æ¯”è¾ƒä¸°å¯Œçš„äº¤äº’åŠŸèƒ½ï¼šç‚¹å‡»äº†æŸä¸€ä¸ªæŒ‰é’®åï¼Œæ‰§è¡ŒæŸä¸ªç‰¹å®šçš„è¡Œä¸ºï¼Œç„¶åå°†å¡ç‰‡é‡æ–°æ¸²æŸ“æˆä¸åŒçš„æ ·å¼ã€‚</p><p>é£ä¹¦çš„å¡ç‰‡äº¤äº’ API æ˜¯æä¾›äº†ä»¥ä¸‹çš„ä¸¤ä¸ªèƒ½åŠ›ï¼Œä½¿å¾—æˆ‘ä»¬å®ç°ä¸Šé¢çš„åŠŸèƒ½æˆä¸ºå¯èƒ½ï¼š</p><ol><li>å¡ç‰‡ç‚¹å‡»æ—¶ï¼Œå¯ä»¥æºå¸¦è‡ªå®šä¹‰çš„ value å€¼åˆ°æœåŠ¡å™¨ï¼›</li><li>æˆ‘ä»¬çš„æœåŠ¡å™¨å¯ä»¥å“åº”å¡ç‰‡çš„ head/body ä¿¡æ¯é‡æ–°æ¸²æŸ“å¯¹åº”çš„æ¶ˆæ¯å¡ç‰‡ï¼›
åŸºäºä¸Šé¢çš„ä¸¤ä¸ªåŸºç¡€èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é£ä¹¦å¡ç‰‡ä¸Šå®ç°ä¸€ä¸ªå®Œæ•´çš„å‰ç«¯ç³»ç»Ÿã€‚</li></ol><h2 id=æ€»ä½“ç³»ç»Ÿè®¾è®¡>æ€»ä½“ç³»ç»Ÿè®¾è®¡</h2><p>å…ˆçœ‹ä¼ ç»Ÿçš„å‰ç«¯ä»£ç è¿è¡Œæ¨¡å¼ï¼Œæµè§ˆå™¨è¿è¡Œçš„ React.js ä»£ç ï¼Œå…¶è¿è¡Œæµç¨‹å¯ä»¥å¤§è‡´åœ°é€šè¿‡ä¸‹å›¾è¡¨ç¤ºï¼š</p><img src=./traditional_fe_system.svg width=100%><p>è€Œåœ¨ç°åœ¨é¢å¯¹çš„ Lark äº¤äº’ç³»ç»Ÿï¼Œä¸Šå›¾ä¸­çš„ show é˜¶æ®µå’Œ deliver é˜¶æ®µæ˜¯é€šè¿‡ç½‘ç»œè¯·æ±‚å¼‚æ­¥å®Œæˆçš„ï¼š</p><img src=./lark_card_interact_system.svg width=100%><p>å¯¹æ¯”ä¸Šé¢ä¸¤ä¸ªæµç¨‹å›¾å‘ç°ä»¥ä¸‹çš„ä¸åŒç‚¹ï¼š</p><ol><li>Lark çš„æµç¨‹ä¸­ç¼ºå¤±äº†äº‹ä»¶ç›‘å¬çš„æµç¨‹ï¼Œæ— æ³•å‡†ç¡®çš„åˆ†å‘å¯¹åº”çš„äº‹ä»¶ï¼›</li><li>Lark çš„äº‹ä»¶åˆ†å‘å’Œæ¸²æŸ“æµç¨‹æ˜¯å‰²è£‚çš„ï¼Œå¯¹åº” Teamo çš„æœåŠ¡å™¨æ¥è¯´æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¯·æ±‚ï¼›</li></ol><p>Teamo å¯ä»¥å¼•å…¥ React çš„ VirtualDOM æ¦‚å¿µè§£å†³äº†ä¸Šé¢çš„ä¸¤ä¸ªé—®é¢˜ï¼ŒåŒæ—¶ä»¥å®ƒä¸ºä¸­é—´ç»“æœï¼Œå°†ç³»ç»Ÿè§£è€¦æˆ SDK/Runtime ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><img src=./decoupling_runtime.svg width=100%><h2 id=sdk-ç³»ç»Ÿå®ç°>SDK ç³»ç»Ÿå®ç°</h2><blockquote><p>SDK éƒ¨åˆ†çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ä»¥ tsx æºä»£ç ä¸ºè¾“å…¥ï¼Œäº§å‡ºä¸€ä¸ª larkNativeDOM çš„æ ‘çŠ¶ç»“æ„ã€‚</p></blockquote><h3 id=tsx-ä»£ç ç¼–è¯‘>Tsx ä»£ç ç¼–è¯‘</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸€ä¸ª Tsx çš„ä»£ç çš„ä¼šè¢«ç¼–è¯‘ä¸º React.createElementï¼š</p><ul><li><code>(&lt;Comp prop="nihao" />)</code></li><li><code>React.createElement(Comp, {prop: "nihao"})</code></li><li>æˆ–è€…åœ¨ React17 ä¹‹åï¼š<code>_jsxRuntime.jsxs(Comp, {prop: "nihao"})</code></li></ul><p>æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥å°† createElement æ›¿æ¢æˆä¸€ä¸ªè‡ªå·±çš„å‡½æ•° tlmCreateElement å‘¢ï¼Œç»è¿‡å‡ å¤©çš„ç ”ç©¶ï¼Œç”¨ babel è¿›è¡Œä»¥ä¸‹çš„é…ç½®å°±å¯ä»¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œè¿™é‡Œå°±ä¸åŠ èµ˜è¿°ï¼š</p><img src=./babel_compile_sequence.svg width=100%><h3 id=é‡æ–°é€ ä¸€ä¸ª-react-çš„è½®å­>é‡æ–°é€ ä¸€ä¸ª React çš„è½®å­</h3><p>ä¸Šé¢çš„ tlmCreateElement è¿™ä¸ªå‡½æ•°å°±ç›¸å½“äºé‡æ–°é€ äº†ä¸€ä¸ª React.createElement çš„ç ´è½®å­ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨ Component/Element ä¸¤å±‚ç»“æ„ï¼Œå…·ä½“çš„ç®€é™‹å®ç°å‚è§ gitlab ä»“åº“ï¼š</p><blockquote><p>gitlab: (å†…éƒ¨é“¾æ¥ï¼Œé‚®ç®±è”ç³»)</p></blockquote><p>æ€»ä¹‹è¿™ä¸€æ­¥çš„è¾“å‡ºæ˜¯ä¸€ä¸ª TlmElement çš„æ ‘çŠ¶ç»“æ„ï¼Œå°†å®ƒä½œä¸º TlmNativeDOM ä¸­ render æ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ª TlmNativeDOM çš„å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹å°†å‚ä¸åç»­ Runtime çš„æµç¨‹ã€‚</p><h3 id=ä¸åŒå½¢çŠ¶çš„è½®å­>ä¸åŒå½¢çŠ¶çš„è½®å­</h3><p>è¿™é‡Œéœ€è¦é‡æ–°å†™ä¸€ä¸ª tlmCreateElement è€Œä¸æ˜¯é‡æ–°å®ç°ä¸€ä¸ª ReactDOM å¹¶ä¸æ˜¯æ²¡æœ‰åŸå› çš„ï¼Œåœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦çš„ä»£ç æœ‰ä»¥ä¸‹çš„æœ¬è´¨åŒºåˆ«ï¼š</p><ol><li>æµè§ˆå™¨ä»£ç éœ€è¦å°† UI è¿…é€Ÿçš„æ¸²æŸ“åˆ°å±å¹•ä¸Šï¼Œç„¶ååœ¨åå°å¼‚æ­¥åœ°æ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼Œå½“ç½‘ç»œè¯·æ±‚ç»“æŸæ—¶ç”¨æ›´æ–°çš„æ–¹å¼é‡æ–°æ¸²æŸ“å¯¹åº”çš„å‰ç«¯é¡µé¢ï¼›</li><li>åœ¨å½“å‰ç³»ç»Ÿä¸­ï¼ŒUI æ˜¯é€šè¿‡ç½‘ç»œè¯·æ±‚â€œä¸€æ¬¡æ€§æ¸²æŸ“â€çš„ï¼Œâ€œæ›´æ–°â€æ“ä½œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ç­‰å¾…æ‰€æœ‰å¼‚æ­¥è¯·æ±‚å®Œæˆåï¼Œæ‰§è¡Œä¸€æ¬¡æ€§æ¸²æŸ“ã€‚</li></ol><p>ä¹Ÿå°±æ˜¯ä¸‹å›¾å‘ˆç°çš„ä¸¤ä¸ªæ¨¡å¼çš„åŒºåˆ«ï¼š</p><img src=./dom_design_difference.svg width=100%><p>è¦å®ç°ä¸‹é¢çš„ç»Ÿä¸€ç­‰å¾…ï¼Œåªéœ€è¦ä¸ºæ¯ä¸ª Component ç»´æŠ¤ä¸€ä¸ªâ€œçº¿ç¨‹æ± â€å°±å¯ä»¥äº†ã€‚å› ä¸ºè¿™ä¸ªâ€œçº¿ç¨‹æ± â€çš„å­˜åœ¨ï¼ŒtlmNativeDOM çš„æ ¸å¿ƒæ–¹æ³• nativeLocalJSON/nativeGlobalJSON éƒ½æ˜¯å¼‚æ­¥æ–¹æ³•ã€‚</p><h2 id=runtime-ç³»ç»Ÿå®ç°>Runtime ç³»ç»Ÿå®ç°</h2><p>Runtime éƒ¨åˆ†çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ï¼Œæ‰¿æ¥ä¸ lark æœåŠ¡å™¨çš„æ‰€æœ‰ç½‘ç»œäº¤äº’ã€ä¸æ•°æ®åº“ç›¸å…³çš„æŒä¹…åŒ–å·¥ä½œï¼Œä½¿å¾—ä¸Šå±‚ SDK éƒ¨åˆ†å¯ä»¥åƒè¿è¡Œåœ¨å•æœºæµè§ˆå™¨ä¸Šçš„çº¯å‰ç«¯ç³»ç»Ÿä¸€æ ·ï¼Œè¿›è¡Œäº‹ä»¶å¤„ç†ã€UI æ¸²æŸ“ç­‰å·¥ä½œã€‚</p><h3 id=æ— çŠ¶æ€æœåŠ¡æ¨¡å‹>æ— çŠ¶æ€æœåŠ¡æ¨¡å‹</h3><p>æœ‰äº† SDK éƒ¨åˆ†è¾“å‡ºçš„ larkNativeDOMï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®¾è®¡å°†è¿™ä¸ª DOM å±•ç¤ºåˆ°é£ä¹¦ä¸Šçš„æµç¨‹ï¼Œå¹¶ä¸”è®¾è®¡ç›¸åº”çš„äº‹ä»¶å¤„ç†ã€ç›‘å¬æœºåˆ¶ã€‚</p><p>å‘é€çš„æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼ˆå¿½ç•¥ç”¨æˆ·ä¸ Lark æœåŠ¡å™¨äº¤äº’çš„éƒ¨åˆ†ï¼Œå°† Lark-Server è§†ä½œä¸€ä¸ªé»‘ç›’ï¼‰ï¼š</p><img src=./stateless_design_1.svg width=100%><p>äº¤äº’çš„é€»è¾‘è¦æ›´å¤æ‚ä¸€äº›ï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯é€šè¿‡ä¸€äº›å˜é‡é‡å»ºäº† DOM åœºæ™¯ï¼Œç„¶ååœ¨é‡å»ºçš„åœºæ™¯ä¸­åˆ†å‘å¯¹åº”çš„ç‚¹å‡»äº‹ä»¶ï¼š</p><img src=./stateless_design_2.svg width=100%><h3 id=æœ‰çŠ¶æ€æœåŠ¡æ¨¡å‹>æœ‰çŠ¶æ€æœåŠ¡æ¨¡å‹</h3><p>Teamo å®Œæ•´åœ°è½åœ°äº†ä¸Šé¢çš„ç»“æ„ï¼Œä½†æ˜¯ä¸Šé¢æ¶æ„æ˜¯ä¸€ä¸ªâ€œå•è¯·æ±‚â€ã€â€œæ— çŠ¶æ€â€æœåŠ¡ï¼Œè½åœ°çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼š</p><ul><li>åœ¨æ¯æ¬¡è¯·æ±‚ä¸­éƒ½åœ¨ Server ç«¯é‡æ–°æ„å»ºä¸€æ¬¡å¡ç‰‡çš„ DOMï¼Œæ„Ÿå®˜ä¸Šè¿™æ˜¯ç›¸å½“æŸè€—æ€§èƒ½çš„ï¼Œç›¸å½“äºâ€œåœ¨ç©æ¸¸æˆï¼Œç©å®¶çš„æ¯æ¬¡æ“ä½œåˆ°æœåŠ¡ç«¯æ—¶ï¼ŒæœåŠ¡ç«¯éƒ½ä»å¤´é‡æ–°æ¸²æŸ“ä¸€æ¬¡æ¸¸æˆåœºæ™¯â€ã€‚</li><li>å®é™…åº”ç”¨çš„è¿‡ç¨‹è¿™ä¸€æ„Ÿå®˜ç¡®å®æ˜¯æ­£ç¡®çš„ï¼Œä¸Šé¢çš„æ–¹æ¡ˆåœ¨ Teamo è½åœ°æ—¶å¹³å‡å“åº”æ—¶é•¿åœ¨ 5-10sã€‚</li><li>è‡´å‘½çš„æ˜¯ï¼šå¦‚æœ lark çš„ä¸€æ¬¡äº¤äº’è¯·æ±‚è€—æ—¶è¿‡é•¿ï¼ŒLark ä¼šä¸»åŠ¨æ–­å¼€è¿æ¥ç»™å®¢æˆ·ç«¯æŠ›å‡ºé”™è¯¯ã€‚</li><li>ç»è¿‡åˆ†æï¼šå…¶ä¸»è¦çš„æ€§èƒ½æŸè€—å°±æ˜¯åœ¨ä¸Šå›¾ä¸­ 3.Compile ä¸ 4.Set clientState è¿™ä¸¤æ­¥ä¸­ã€‚</li></ul><p>è§£å†³æ–¹æ¡ˆï¼š</p><ul><li>å‚è€ƒâ€œæ¸¸æˆæˆ¿é—´â€çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡ç«¯ç¼“å­˜æ¯ä¸ªæ¶ˆæ¯çš„ DOM æ ‘ï¼›</li><li>å¦‚æœç¼“å­˜çš„ DOM æ ‘æ˜¯æ­£ç¡®åˆç†çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è·³è¿‡ 2-4 è¿™æœ€è€—æ—¶çš„ä¸‰æ­¥ï¼›</li></ul><p>å‘½ä¸­ç¼“å­˜æ—¶çš„äº¤äº’é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p><img src=./stateful_service_design.svg width=100%><p>Teamo è½åœ°ä½¿ç”¨äº†ç®€å•çš„ Lru å†…å­˜ç¼“å­˜å¡ç‰‡çš„ DOM æ ‘ï¼Œå¹³å‡å“åº”æ—¶é•¿åŸºæœ¬é™ä½ä¸º 1ms-500msï¼Œæå‡äº† 10 å€çš„æ€§èƒ½ï¼›</p><h2 id=é—ç•™çš„é—®é¢˜>é—ç•™çš„é—®é¢˜</h2><p>å› ä¸ºæ—¶é—´é—®é¢˜ï¼Œæœ¬ç³»ç»Ÿè¿˜æœ‰å¤§é‡çš„é—ç•™é—®é¢˜æ²¡æœ‰è§£å†³ã€‚</p><ol><li>å•å…ƒæµ‹è¯•è¿è¡Œé—®é¢˜</li><li>IDE ä»£ç è¡¥å…¨é—®é¢˜</li><li>æœ‰çŠ¶æ€æœåŠ¡çš„å¤šå®¢æˆ·ç«¯é—®é¢˜</li></ol><p>å…¶ä¸­ç¬¬ä¸‰ä¸ªï¼Œå¯¹æ¶ˆæ¯ DOM æ ‘è¿›è¡Œç¼“å­˜ï¼Œæˆ‘ä»¬çš„æœåŠ¡å°±å˜æˆäº†ä¸€ä¸ªâ€œæœ‰çŠ¶æ€æœåŠ¡â€ï¼Œè¿™æ—¶å°±ä¸å¾—ä¸è€ƒè™‘å¤šå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ã€å¤šå®¢æˆ·ç«¯å¡ç‰‡æ˜¯å¦å…±äº«ã€æœåŠ¡æœ¬èº«æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²çš„é—®é¢˜ã€‚</p><p>æ€»çš„æ¥è¯´å°±æ˜¯æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸‹é¢çš„æ‹“æ‰‘å›¾ï¼š</p><img src=./multi_client_problem.svg width=100%><p>è§£å†³è¿™ä¸ªé—®é¢˜æœ‰ä¸€äº›ç®€å•çš„æ€è·¯ï¼š</p><ul><li>å¯¹æ¯ä¸ªå®¢æˆ·ç«¯å±•ç¤ºçš„å¡ç‰‡ç»™äºˆä¸€ä¸ª version ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡äº¤äº’è¯·æ±‚åç‰ˆæœ¬å·åŠ ä¸€ï¼›</li><li>ä¸ºé¿å…å¤šä¸ªæœåŠ¡ç«¯ç¼“å­˜äº†åŒä¸€ä¸ªå¡ç‰‡çš„ä¿¡æ¯ï¼Œåœ¨è·å–å†…å­˜ç¼“å­˜ä¹‹å‰åº”è¯¥é€šè¿‡ ZooKeeper ç­‰ç³»ç»Ÿå®ç°ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼›</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>æ›´æ–°äº 2022-01-07</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="åˆ†äº«åˆ° Twitter" data-sharer=twitter data-url=http://shesl-meow.github.io/posts/%E7%94%A8-reacttsx-%E8%AF%AD%E6%B3%95%E5%8F%91%E9%80%81%E9%A3%9E%E4%B9%A6%E4%BA%A4%E4%BA%92%E5%8D%A1%E7%89%87/ data-title=":speech_balloon:ç”¨ ReactTsx è¯­æ³•å‘é€é£ä¹¦äº¤äº’å¡ç‰‡" data-hashtags=å‰ç«¯,æœåŠ¡ç«¯,TypeScript,å­—èŠ‚è·³åŠ¨><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° Facebook" data-sharer=facebook data-url=http://shesl-meow.github.io/posts/%E7%94%A8-reacttsx-%E8%AF%AD%E6%B3%95%E5%8F%91%E9%80%81%E9%A3%9E%E4%B9%A6%E4%BA%A4%E4%BA%92%E5%8D%A1%E7%89%87/ data-hashtag=å‰ç«¯><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° å¾®åš" data-sharer=weibo data-url=http://shesl-meow.github.io/posts/%E7%94%A8-reacttsx-%E8%AF%AD%E6%B3%95%E5%8F%91%E9%80%81%E9%A3%9E%E4%B9%A6%E4%BA%A4%E4%BA%92%E5%8D%A1%E7%89%87/ data-title=":speech_balloon:ç”¨ ReactTsx è¯­æ³•å‘é€é£ä¹¦äº¤äº’å¡ç‰‡" data-ralateuid=3968720593><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/%E5%89%8D%E7%AB%AF/>å‰ç«¯</a>,&nbsp;<a href=/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/>æœåŠ¡ç«¯</a>,&nbsp;<a href=/tags/typescript/>TypeScript</a>,&nbsp;<a href=/tags/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8/>å­—èŠ‚è·³åŠ¨</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>è¿”å›</a></span>&nbsp;|&nbsp;<span><a href=/>ä¸»é¡µ</a></span></section></div><div class=post-nav><a href=/posts/%E6%96%87%E6%A1%A3%E6%95%B0%E6%8D%AE%E5%BA%93-mongodb-%E5%8E%9F%E7%90%86%E6%B5%85%E6%9E%90/ class=prev rel=prev title=":page_facing_up:æ–‡æ¡£æ•°æ®åº“ MongoDB åŸç†æµ…æ"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>ğŸ“„æ–‡æ¡£æ•°æ®åº“ MongoDB åŸç†æµ…æ</a>
<a href=/posts/c++-coredump-%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/ class=next rel=next title=":pager:C++ CoreDump æ¡ˆä¾‹åˆ†æ">ğŸ“ŸC++ CoreDump æ¡ˆä¾‹åˆ†æ<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://shesl-meow.github.io target=_blank>ä½˜å´§æ—</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=å›åˆ°é¡¶éƒ¨><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=æŸ¥çœ‹è¯„è®º><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/valine@1.5.0/dist/Valine.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.8127f0ca4cabc7246f3620f3ef3bf9b1db02805dfe03d6d4c57bc74bc0bf6eea.js integrity="sha256-gSfwykyrxyRvNiDz7zv5sdsCgF3+A9bUxXvHS8C/buo="></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.825fab54c26891370cbd3df4cdff5c9de31af8bb84474e6774573463d8708ae7.js integrity="sha256-gl+rVMJokTcMvT30zf9cneMa+LuER05ndFc0Y9hwiuc="></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"å¤åˆ¶åˆ°å‰ªè´´æ¿",maxShownLines:50},comment:{valine:{appId:"zDVJohJIQbD6f3W267xtaYRC-gzGzoHsz",appKey:"ewsfU9ocNOeuvt0MzONe6yKx",avatar:"mp",el:"#valine",emojiCDN:"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/",emojiMaps:{100:"1f4af.png",alien:"1f47d.png",anger:"1f4a2.png",angry:"1f620.png",anguished:"1f627.png",astonished:"1f632.png",black_heart:"1f5a4.png",blue_heart:"1f499.png",blush:"1f60a.png",bomb:"1f4a3.png",boom:"1f4a5.png",broken_heart:"1f494.png",brown_heart:"1f90e.png",clown_face:"1f921.png",cold_face:"1f976.png",cold_sweat:"1f630.png",confounded:"1f616.png",confused:"1f615.png",cry:"1f622.png",crying_cat_face:"1f63f.png",cupid:"1f498.png",dash:"1f4a8.png",disappointed:"1f61e.png",disappointed_relieved:"1f625.png",dizzy:"1f4ab.png",dizzy_face:"1f635.png",drooling_face:"1f924.png",exploding_head:"1f92f.png",expressionless:"1f611.png",face_vomiting:"1f92e.png",face_with_cowboy_hat:"1f920.png",face_with_hand_over_mouth:"1f92d.png",face_with_head_bandage:"1f915.png",face_with_monocle:"1f9d0.png",face_with_raised_eyebrow:"1f928.png",face_with_rolling_eyes:"1f644.png",face_with_symbols_on_mouth:"1f92c.png",face_with_thermometer:"1f912.png",fearful:"1f628.png",flushed:"1f633.png",frowning:"1f626.png",ghost:"1f47b.png",gift_heart:"1f49d.png",green_heart:"1f49a.png",grimacing:"1f62c.png",grin:"1f601.png",grinning:"1f600.png",hankey:"1f4a9.png",hear_no_evil:"1f649.png",heart:"2764-fe0f.png",heart_decoration:"1f49f.png",heart_eyes:"1f60d.png",heart_eyes_cat:"1f63b.png",heartbeat:"1f493.png",heartpulse:"1f497.png",heavy_heart_exclamation_mark_ornament:"2763-fe0f.png",hole:"1f573-fe0f.png",hot_face:"1f975.png",hugging_face:"1f917.png",hushed:"1f62f.png",imp:"1f47f.png",innocent:"1f607.png",japanese_goblin:"1f47a.png",japanese_ogre:"1f479.png",joy:"1f602.png",joy_cat:"1f639.png",kiss:"1f48b.png",kissing:"1f617.png",kissing_cat:"1f63d.png",kissing_closed_eyes:"1f61a.png",kissing_heart:"1f618.png",kissing_smiling_eyes:"1f619.png",laughing:"1f606.png",left_speech_bubble:"1f5e8-fe0f.png",love_letter:"1f48c.png",lying_face:"1f925.png",mask:"1f637.png",money_mouth_face:"1f911.png",nauseated_face:"1f922.png",nerd_face:"1f913.png",neutral_face:"1f610.png",no_mouth:"1f636.png",open_mouth:"1f62e.png",orange_heart:"1f9e1.png",partying_face:"1f973.png",pensive:"1f614.png",persevere:"1f623.png",pleading_face:"1f97a.png",pouting_cat:"1f63e.png",purple_heart:"1f49c.png",rage:"1f621.png",relaxed:"263a-fe0f.png",relieved:"1f60c.png",revolving_hearts:"1f49e.png",right_anger_bubble:"1f5ef-fe0f.png",robot_face:"1f916.png",rolling_on_the_floor_laughing:"1f923.png",scream:"1f631.png",scream_cat:"1f640.png",see_no_evil:"1f648.png",shushing_face:"1f92b.png",skull:"1f480.png",skull_and_crossbones:"2620-fe0f.png",sleeping:"1f634.png",sleepy:"1f62a.png",slightly_frowning_face:"1f641.png",slightly_smiling_face:"1f642.png",smile:"1f604.png",smile_cat:"1f638.png",smiley:"1f603.png",smiley_cat:"1f63a.png",smiling_face_with_3_hearts:"1f970.png",smiling_imp:"1f608.png",smirk:"1f60f.png",smirk_cat:"1f63c.png",sneezing_face:"1f927.png",sob:"1f62d.png",space_invader:"1f47e.png",sparkling_heart:"1f496.png",speak_no_evil:"1f64a.png",speech_balloon:"1f4ac.png","star-struck":"1f929.png",stuck_out_tongue:"1f61b.png",stuck_out_tongue_closed_eyes:"1f61d.png",stuck_out_tongue_winking_eye:"1f61c.png",sunglasses:"1f60e.png",sweat:"1f613.png",sweat_drops:"1f4a6.png",sweat_smile:"1f605.png",thinking_face:"1f914.png",thought_balloon:"1f4ad.png",tired_face:"1f62b.png",triumph:"1f624.png",two_hearts:"1f495.png",unamused:"1f612.png",upside_down_face:"1f643.png",weary:"1f629.png",white_frowning_face:"2639-fe0f.png",white_heart:"1f90d.png",wink:"1f609.png",woozy_face:"1f974.png",worried:"1f61f.png",yawning_face:"1f971.png",yellow_heart:"1f49b.png",yum:"1f60b.png",zany_face:"1f92a.png",zipper_mouth_face:"1f910.png",zzz:"1f4a4.png"},enableQQ:!1,highlight:!0,lang:"zh-CN",pageSize:10,placeholder:"ä½ çš„è¯„è®º ...",recordIP:!0,serverURLs:"https://zdvjohji.lc-cn-n1-shared.com",visitor:!0}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"æ²¡æœ‰æ‰¾åˆ°ç»“æœ",snippetLength:30}}</script><script type=text/javascript src=/js/theme.min.d7121d72cd85153ec9d35a888cee3eb28c2700ca763f649a538f6c772d750021.js integrity="sha256-1xIdcs2FFT7J01qIjO4+sownAMp2P2SaU49sdy11ACE="></script></body></html>