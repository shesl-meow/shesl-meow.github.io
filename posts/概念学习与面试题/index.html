<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>:ambulance:æ¦‚å¿µå­¦ä¹ ä¸é¢è¯•é¢˜ - shesl's blog</title><meta name=Description content="ä½˜å´§æ—åŒå­¦çš„ç¢ç¢å¿µåšå®¢"><meta property="og:title" content=":ambulance:æ¦‚å¿µå­¦ä¹ ä¸é¢è¯•é¢˜">
<meta property="og:description" content="å¸¸è§ç®—æ³•å°è®° Fisherâ€“Yates shuffle æ´—ç‰Œç®—æ³•ï¼šhttps://en.wikipedia.org/wiki/Fisher%E2%80%93Y"><meta property="og:type" content="article"><meta property="og:url" content="http://shesl-meow.github.io/posts/%E6%A6%82%E5%BF%B5%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%A2%E8%AF%95%E9%A2%98/"><meta property="og:image" content="http://shesl-meow.github.io/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-12-30T00:00:00+08:00"><meta property="article:modified_time" content="2018-12-30T00:00:00+08:00"><meta property="og:site_name" content="shesl's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://shesl-meow.github.io/avatar.png"><meta name=twitter:title content=":ambulance:æ¦‚å¿µå­¦ä¹ ä¸é¢è¯•é¢˜"><meta name=twitter:description content="å¸¸è§ç®—æ³•å°è®° Fisherâ€“Yates shuffle æ´—ç‰Œç®—æ³•ï¼šhttps://en.wikipedia.org/wiki/Fisher%E2%80%93Y"><meta name=application-name content="shesl's blog"><meta name=apple-mobile-web-app-title content="shesl's blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://shesl-meow.github.io/posts/%E6%A6%82%E5%BF%B5%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%A2%E8%AF%95%E9%A2%98/><link rel=prev href=http://shesl-meow.github.io/posts/linux-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/><link rel=next href=http://shesl-meow.github.io/posts/%E5%A0%86%E5%8C%BA%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/><link rel=stylesheet href=/css/style.min.f9dcece0006720752966c5ab2d548675424bb8b985943a9e2d120f7b736cf8eb.css integrity="sha256-+dzs4ABnIHUpZsWrLVSGdUJLuLmFlDqeLRIPe3Ns+Os="><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":":ambulance:æ¦‚å¿µå­¦ä¹ ä¸é¢è¯•é¢˜","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/shesl-meow.github.io\/posts\/%E6%A6%82%E5%BF%B5%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%A2%E8%AF%95%E9%A2%98\/"},"genre":"posts","keywords":"æŒç»­æ›´æ–°, ç®—æ³•, æœåŠ¡ç«¯","wordcount":5696,"url":"http:\/\/shesl-meow.github.io\/posts\/%E6%A6%82%E5%BF%B5%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%A2%E8%AF%95%E9%A2%98\/","datePublished":"2018-12-30T00:00:00+08:00","dateModified":"2018-12-30T00:00:00+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"ä½˜å´§æ—"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><script src=https://unpkg.com/vue@2></script><div class=header-wrapper><div class=header-title><a href=/ title="shesl's blog">shesl-meow</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>åšå®¢
</a><a class=menu-item href=/tags/>æ ‡ç­¾
</a><a class=menu-item href=/categories/>åˆ†ç±»
</a><a class=menu-item href=/note/>ç¬”è®°</a><div class=dropdown><a class="menu-item menu-more dropbtn" title href=javascript:void(0);>æ¸¸æˆ</a><div class="menu-more-content dropdown-content"><a href=/games/2048/ title><i class='fa-solid fa-puzzle-piece'></i> 2048 </a><a href=/games/schulte/ title><i class='fa-solid fa-chess-board'></i> Schulte</a></div></div><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=æœç´¢><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=æ¸…ç©º><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="shesl's blog">shesl-meow</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=æœç´¢><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=æ¸…ç©º><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>å–æ¶ˆ</a></div><a class=menu-item href=/posts/>åšå®¢
</a><a class=menu-item href=/tags/>æ ‡ç­¾
</a><a class=menu-item href=/categories/>åˆ†ç±»
</a><a class=menu-item href=/note/>ç¬”è®°</a><div class=dropdown><a class="menu-item menu-more dropbtn" title href=javascript:void(0);>æ¸¸æˆ</a><div class="menu-more-content dropdown-content"><a href=/games/2048/ title><i class='fa-solid fa-puzzle-piece'></i> 2048 </a><a href=/games/schulte/ title><i class='fa-solid fa-chess-board'></i> Schulte</a></div></div><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>ç›®å½•</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ğŸš‘æ¦‚å¿µå­¦ä¹ ä¸é¢è¯•é¢˜</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://shesl-meow.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>ä½˜å´§æ—</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2018-12-30>2018-12-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;çº¦ 5696 å­—&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;é¢„è®¡é˜…è¯» 12 åˆ†é’Ÿ&nbsp;<span id=/posts/%E6%A6%82%E5%BF%B5%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%A2%E8%AF%95%E9%A2%98/ class=leancloud_visitors data-flag-title=:ambulance:æ¦‚å¿µå­¦ä¹ ä¸é¢è¯•é¢˜>
<i class="far fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;æ¬¡é˜…è¯»
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>ç›®å½•</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#å¸¸è§ç®—æ³•å°è®°>å¸¸è§ç®—æ³•å°è®°</a></li><li><a href=#æ—¶åºæ•°æ®åº“-tsdb>æ—¶åºæ•°æ®åº“ TSDB</a></li><li><a href=#restful>RESTful</a></li><li><a href=#graphql>GraphQL</a></li><li><a href=#thrift-rpc>Thrift-RPC</a></li><li><a href=#session-base-authentication>Session Base Authentication</a><ul><li><a href=#æµç¨‹ç®€ä»‹>æµç¨‹ç®€ä»‹</a></li></ul></li><li><a href=#jwt-json-web-token>JWT (Json Web Token)</a><ul><li><a href=#æ ¼å¼>æ ¼å¼</a></li><li><a href=#å·¥ä½œæµ>å·¥ä½œæµ</a></li><li><a href=#ä¼˜ç‚¹ä¸ç¼ºç‚¹>ä¼˜ç‚¹ä¸ç¼ºç‚¹</a></li><li><a href=#nodejs-ç”Ÿæ€>nodejs ç”Ÿæ€</a></li></ul></li><li><a href=#oauth-open-authorization>OAuth (Open Authorization)</a></li><li><a href=#æœåŠ¡å‘ç°>æœåŠ¡å‘ç°</a></li><li><a href=#æœåŠ¡é™æµ>æœåŠ¡é™æµ</a></li><li><a href=#æœåŠ¡é›ªå´©é™çº§ç†”æ–­>æœåŠ¡é›ªå´©é™çº§ç†”æ–­</a></li><li><a href=#ç‰ˆæœ¬æ§åˆ¶>ç‰ˆæœ¬æ§åˆ¶</a><ul><li><a href=#é›†ä¸­å¼ç‰ˆæœ¬ç³»ç»Ÿ>é›†ä¸­å¼ç‰ˆæœ¬ç³»ç»Ÿ</a></li><li><a href=#åˆ†å¸ƒå¼ç‰ˆæœ¬ç³»ç»Ÿ>åˆ†å¸ƒå¼ç‰ˆæœ¬ç³»ç»Ÿ</a></li><li><a href=#git-æ–‡ä»¶ç³»ç»Ÿ>Git æ–‡ä»¶ç³»ç»Ÿ</a></li></ul></li><li><a href=#acid-ç†è®º>ACID ç†è®º</a></li><li><a href=#åˆ†å¸ƒå¼ç³»ç»Ÿ>åˆ†å¸ƒå¼ç³»ç»Ÿ</a></li><li><a href=#cap-ç†è®º>CAP ç†è®º</a></li><li><a href=#base-ç†è®º>BASE ç†è®º</a></li><li><a href=#roaring-bitmap>Roaring Bitmap</a><ul><li><a href=#èƒŒæ™¯>èƒŒæ™¯</a></li><li><a href=#ç«å“è§£å†³æ–¹æ¡ˆ>ç«å“è§£å†³æ–¹æ¡ˆ</a></li><li><a href=#ç©ºé—´å¤æ‚åº¦åˆ†æ>ç©ºé—´å¤æ‚åº¦åˆ†æ</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=å¸¸è§ç®—æ³•å°è®°>å¸¸è§ç®—æ³•å°è®°</h2><p>Fisherâ€“Yates shuffle æ´—ç‰Œç®—æ³•ï¼šhttps://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle</p><p>Boyer-Moore å¤šæ•°æŠ•ç¥¨ç®—æ³•ï¼šhttps://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_majority_vote_algorithm</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=kd>func</span> <span class=nf>majorityElement</span><span class=p>(</span><span class=nx>nums</span> <span class=p>[]</span><span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>iter</span><span class=p>,</span> <span class=nx>most</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span><span class=nx>num</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>nums</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>iter</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span> <span class=nx>most</span><span class=p>,</span> <span class=nx>iter</span> <span class=p>=</span> <span class=nx>num</span><span class=p>,</span> <span class=nx>iter</span><span class=o>+</span><span class=mi>1</span> <span class=p>}</span> 
</span></span><span class=line><span class=cl>      	<span class=k>else</span> <span class=k>if</span> <span class=nx>most</span> <span class=o>==</span> <span class=nx>num</span> <span class=p>{</span> <span class=nx>iter</span> <span class=o>+=</span> <span class=mi>1</span> <span class=p>}</span> 
</span></span><span class=line><span class=cl>      	<span class=k>else</span> <span class=p>{</span> <span class=nx>iter</span> <span class=o>-=</span> <span class=mi>1</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=p>,</span> <span class=nx>sz</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span><span class=nx>num</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>nums</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>num</span> <span class=o>==</span> <span class=nx>most</span> <span class=p>{</span> <span class=nx>count</span> <span class=o>+=</span> <span class=mi>1</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nx>count</span> <span class=o>*</span> <span class=mi>2</span> <span class=p>&gt;</span> <span class=nx>sz</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>most</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç´ æ€§æ£€æµ‹ç®—æ³•ï¼šå…³äºä¸€äº›ç´ æ€§æ£€æµ‹çš„åº•å±‚ç®—æ³•ï¼Œåœ¨å­¦æ ¡æ—¶ï¼Œ<a href=../../book/%e7%b3%bb%e7%bb%9f%e7%90%86%e8%ae%ba%e8%af%be%e7%a8%8b/%e4%bf%a1%e6%81%af%e5%ae%89%e5%85%a8%e6%95%b0%e5%ad%a6%e5%9f%ba%e7%a1%80/8.%e6%95%b0%e8%ae%ba%e5%ba%94%e7%94%a8 rel>ä¿¡æ¯å®‰å…¨æ•°å­¦åŸºç¡€è¯¾</a>ä¸Šè®²è¿‡ã€‚</p><p>ç´ æ•°æ•°é‡è®¡ç®—ï¼Œ<code>Sieve of Eratosthenes</code>ï¼Œç­›æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>algorithm Sieve of Eratosthenes is
</span></span><span class=line><span class=cl>    input: an integer n &gt; 1.
</span></span><span class=line><span class=cl>    output: all prime numbers from 2 through n.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    let A be an array of Boolean values, indexed by integers 2 to n,
</span></span><span class=line><span class=cl>    initially all set to true.
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    for i = 2, 3, 4, ..., not exceeding âˆšn do
</span></span><span class=line><span class=cl>        if A[i] is true
</span></span><span class=line><span class=cl>            for j = i2, i2+i, i2+2i, i2+3i, ..., not exceeding n do
</span></span><span class=line><span class=cl>                A[j] := false
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    return all i such that A[i] is true.
</span></span></code></pre></td></tr></table></div></div><h2 id=æ—¶åºæ•°æ®åº“-tsdb>æ—¶åºæ•°æ®åº“ TSDB</h2><p>æ—¶åºæ•°æ®çš„ç‰¹ç‚¹ï¼š</p><ul><li>æ•°æ®æŒ‰ç…§æ—¶é—´ä¸¥æ ¼å•è°ƒæ’åºï¼›</li><li>Append Onlyï¼šåªèƒ½å‘åæ’å…¥æ•°æ®ï¼Œä¸èƒ½æ›´æ–°ï¼›</li><li>å†™æ•°é‡è¿œå¤§äºè¯»æ•°é‡ï¼šå¤§äº 90% çš„æ•°æ®ä»æœªè¢«è¯»å–ï¼›</li><li>æ•°æ®é‡çº§ç‰¹åˆ«å¤§ï¼Œä½†æ˜¯ç›¸å¯¹æ¯”è¾ƒç¨³å®šï¼›</li><li>éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ•°æ®çš„ä»·å€¼å‡å°ï¼Œæœ€è¿‘æ•°æ®çš„ä»·å€¼é«˜äºå†å²æ•°æ®ï¼›</li><li>é€šå¸¸ä¸ <code>tag</code> èšåˆåœ¨ä¸€èµ·ï¼Œæ ¹æ®æ—¶é—´èŒƒå›´è¿›è¡ŒæŸ¥è¯¢ï¼›</li></ul><p>Metrics æ˜¯å­—èŠ‚è·³åŠ¨å®ç° tsdb çš„è§£å†³æ–¹æ¡ˆï¼Œå¾ˆå¤šå¹³å°çš„æ•°æ®æºéƒ½æ¥è‡ª Metricsï¼š</p><ul><li><code>alarm</code>ã€<code>grafana</code>ã€<code>metro-fe</code>ã€<code>argos</code>ï¼›</li></ul><p>Metrics ç³»ç»Ÿæ¶æ„åˆ†ä¸ºä¸‰çº§ï¼š</p><ol><li>SDK ä¾§ï¼šé€šè¿‡ SDK å°†æ—¥å¿—ä¿¡æ¯å‘é€åˆ° <code>agent</code>ï¼Œ<code>agent</code> é€šè¿‡ <code>producer</code> å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼›</li><li>æ ¸å¿ƒé€»è¾‘ï¼š<code>consimer</code>/<code>preshuffle</code> ä¸¤ä¸ªæ¶ˆè´¹é€»è¾‘é“¾è·¯ï¼Œåˆ†åˆ«å°†æ•°æ®å­˜å‚¨åˆ°å†·çƒ­å­˜å‚¨çš„ä¸¤ä¸ªä¸åŒæ•°æ®åº“ä¸­ï¼›</li><li>æ•°æ®å­˜å‚¨ï¼šé€Ÿåº¦å¿«çš„â€œçƒ­å­˜å‚¨â€TSDCã€é€Ÿåº¦è¾ƒæ…¢çš„â€œå†·å­˜å‚¨â€mstoreï¼›</li></ol><p>Open Sourceï¼š</p><ul><li>åœ¨ä¸šç•Œæœ‰å¾ˆå¤šå¼€æºçš„è§£å†³æ–¹æ¡ˆï¼š<code>Influxdb</code>ã€<code>Opentsdb</code>ã€<code>Druid</code>ã€<code>Elasticsearch</code>ã€<code>Beringei</code> ç­‰ï¼›</li></ul><h2 id=restful>RESTful</h2><blockquote><p>For TypeScript: <a href=https://github.com/thiagobustamante/typescript-rest target=_blank rel="noopener noreffer">https://github.com/thiagobustamante/typescript-rest</a></p></blockquote><p>REST: Representational state transfer.</p><p>RESTful æ˜¯ä¸€ç§é¢å‘èµ„æºçš„è¿‡æ—¶ API è®¾è®¡ç†å¿µï¼Œä»–åŸºäº http åè®®ï¼Œæ²¡æœ‰å•ç‹¬å®šä¹‰è‡ªå·±çš„ä¸€å¥—åè®®ï¼Œåªæ˜¯ä¸€ç§ API è®¾è®¡èŒƒå¼ã€‚</p><p>å®ƒæä¾›äº†å››ä¸ªæŒ‡å¯¼åŸåˆ™ï¼š</p><ol><li>Resource-Base åŸºäºèµ„æºçš„ï¼šä¸€ä¸ª uri å•ç‹¬å¯¹åº”äºä¸€ä¸ªèµ„æºï¼›</li><li>Manipulation Through Representations åŠ¨ä½œè¡¨ç¤ºï¼šå¯¹èµ„æºçš„ä¸åŒåŠ¨ä½œé€šè¿‡æ–¹æ³•æˆ–å‚æ•°è¡¨ç¤ºï¼›</li><li>Self-Descriptive Message è‡ªæè¿°ä¿¡æ¯ï¼šæ¯æ¡è¯·æ±‚éƒ½èƒ½æ²¡æœ‰ä¸Šä¸‹æ–‡åœ°æ— çŠ¶æ€åœ°ï¼Œå”¯ä¸€æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œï¼›</li><li>Hypermedia as the Engine of Application State (HATEOAS)ï¼šç”¨é«˜çº§çš„è¯·æ±‚ä½“æ¥è¡¨ç¤ºçŠ¶æ€ï¼›</li></ol><h2 id=graphql>GraphQL</h2><blockquote><p>For TypeScript: <a href=https://github.com/MichalLytek/type-graphql target=_blank rel="noopener noreffer">https://github.com/MichalLytek/type-graphql</a>, <a href=https://typegraphql.com/ target=_blank rel="noopener noreffer">https://typegraphql.com/</a></p><p>Official Website: <a href=https://graphql.org/ target=_blank rel="noopener noreffer">https://graphql.org/</a></p></blockquote><p>GraphQL: Graph Query Language.</p><ul><li><p>ä»‹ç»ï¼šGraphQL æ˜¯ Facebook ä¸ºäº†è§£å†³ RESTful è®¾è®¡æ¨¡å¼åœ¨ç³»ç»Ÿåºå¤§ä¹‹åå‡ºç°çš„å„ç§é—®é¢˜åº”è¿è€Œç”Ÿçš„æ¥å£æè¿°è¯­è¨€ã€‚</p></li><li><p>åœ¨ API è®¾è®¡è¿™ä¸ªé—®é¢˜ä¸Šï¼šGraph API å¯¹å¤–åªæš´éœ²ä¸€ä¸ªæ¥å£ï¼ˆæ¯”å¦‚ï¼šhttps://leetcode.com/graphqlï¼‰ï¼Œèµ„æºé€šè¿‡å›¾çš„æ–¹å¼å…³è”å¼åœ°è®¾è®¡åœ¨è¿™ä¸ªæ¥å£ä¸­ã€‚</p></li><li><p>ä¸ RESTfulï¼šåœ¨ç³»ç»Ÿä¸­ï¼ŒGraphQL ä¸ RESTful é€šå¸¸æ˜¯åŒæ—¶å­˜åœ¨çš„å…³ç³»è€Œä¸æ˜¯å®Œå…¨å–ä»£ã€‚</p></li></ul><p><em>PS</em>: è®¸å¤šè¯¸å¦‚ GraphQL ä¸ RESTful çš„åŒºåˆ«ç­‰é—®é¢˜å¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„æ–‡æ¡£ï¼šhttps://graphql.org/faq/#does-graphql-use-http</p><h2 id=thrift-rpc>Thrift-RPC</h2><blockquote><p>å®˜æ–¹ï¼šhttps://thrift.apache.org/ã€</p><p>IDL æ–‡æ¡£ï¼šhttps://thrift.apache.org/docs/idl.html</p></blockquote><p>Thrift æ˜¯ä»€ä¹ˆï¼ŒApache æä¾›çš„ä¸€ä¸ª API åºåˆ—åŒ–æ¡†æ¶ï¼š</p><ul><li>Apache Thrift æ˜¯ä¸€ä¸ªè·¨è¯­éŸ³çš„å¯æ‰©å±•æœåŠ¡å™¨å¼€å‘æ¡†æ¶ï¼Œå¯ä»¥åœ¨è¯­è¨€é—´æ— ç¼é«˜æ•ˆåœ°è¿ç§»ã€‚</li></ul><h2 id=session-base-authentication>Session Base Authentication</h2><blockquote><p>å‚è€ƒï¼š</p><ul><li><a href=https://sherryhsu.medium.com/session-vs-token-based-authentication-11a6c5ac45e4 target=_blank rel="noopener noreffer">https://sherryhsu.medium.com/session-vs-token-based-authentication-11a6c5ac45e4</a></li><li><a href=https://jwt.io/introduction target=_blank rel="noopener noreffer">https://jwt.io/introduction</a></li><li><a href=https://stackoverflow.com/questions/43452896/authentication-jwt-usage-vs-session target=_blank rel="noopener noreffer">https://stackoverflow.com/questions/43452896/authentication-jwt-usage-vs-session</a></li><li><a href=https://en.wikipedia.org/wiki/OAuth target=_blank rel="noopener noreffer">https://en.wikipedia.org/wiki/OAuth</a></li></ul></blockquote><h3 id=æµç¨‹ç®€ä»‹>æµç¨‹ç®€ä»‹</h3><p>æœ€ä¼ ç»Ÿçš„ç”¨æˆ·ç³»ç»Ÿï¼Œdjango çš„é»˜è®¤å®ç°ï¼Œç”¨æˆ·ç™»é™†æ—¶åæœåŠ¡ç«¯ä¼šä¸ºå½“å‰ä¼šè¯åˆ›å»ºä¸€ä¸ª <code>session</code> å¹¶ä¸”å°† <code>sessionID</code> ä½œä¸º cookie è®¾ç½®åˆ°å®¢æˆ·ç«¯ä¸Šï¼Œç”¨æˆ·æ¯æ¬¡éœ€è¦è®¿é—®æ•æ„Ÿèµ„æºæ—¶éœ€è¦å¸¦ä¸Š <code>sessionID</code>ï¼ŒæœåŠ¡ç«¯é€šè¿‡ session åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†æˆåŠŸã€‚ç®€å•æµç¨‹å¦‚ä¸‹ï¼š</p><p><img class=lazyload src=/svg/loading.min.svg data-src=./session_base_authentication.png data-srcset="./session_base_authentication.png, ./session_base_authentication.png 1.5x, ./session_base_authentication.png 2x" data-sizes=auto alt=./session_base_authentication.png title=session_base_authentication></p><h2 id=jwt-json-web-token>JWT (Json Web Token)</h2><h3 id=æ ¼å¼>æ ¼å¼</h3><p>JWT æ˜¯ä¸€ç§è¢«å†™å…¥ <a href=https://datatracker.ietf.org/doc/html/rfc7519 target=_blank rel="noopener noreffer">RFC7519</a> çš„åè®®æ ‡å‡†ã€‚ä¸€ä¸ª JWT çš„æ ¼å¼ç”± Base64 åŠ å¯†çš„ â€œHeaderâ€ã€â€œPayloadâ€ã€â€œSignatureâ€ ä¸‰ä¸ªéƒ¨åˆ†ç”± <code>.</code> å­—ç¬¦æ‹¼æ¥è€Œæˆï¼š</p><p><img class=lazyload src=/svg/loading.min.svg data-src=./jwt_format.png data-srcset="./jwt_format.png, ./jwt_format.png 1.5x, ./jwt_format.png 2x" data-sizes=auto alt=./jwt_format.png title=jwt_format></p><p>ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºä¸‰éƒ¨åˆ†çš„ä½œç”¨ï¼š</p><ol><li><code>header</code> éƒ¨åˆ†è¡¨ç¤ºå½“å‰ JWT çš„ç®—æ³•ï¼›</li><li><code>playload</code> åˆ™å­˜å‚¨äº†å½“å‰ç™»é™†ç”¨æˆ·çš„ä¿¡æ¯ï¼ˆåœ¨ä¼ ç»ŸåŸºäº <code>session</code> çš„ç™»é™†ç³»ç»Ÿä¸‹ï¼Œè¿™ä¸€ä¿¡æ¯ä¸€èˆ¬æ˜¯å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼‰ï¼Œ<code>Playload</code> åˆ†ä¸º <code>Registered claims</code>/<code>Public claims</code>/<code>Private claims</code> ä¸‰ä¸ªç±»å‹ï¼›</li><li><code>signature</code> ç”¨æœåŠ¡ç«¯çš„ç§é’¥è¿›è¡Œ HMAC ç¡®ä¿ <code>playload</code> ä¸­çš„ä¿¡æ¯æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼›</li></ol><h3 id=å·¥ä½œæµ>å·¥ä½œæµ</h3><p>åœ¨è®¤è¯æˆåŠŸåï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ª JWTã€‚å½“å®¢æˆ·ç«¯éœ€è¦è®¿é—®ä»»ä½•æ•æ„Ÿèµ„æºæ—¶ï¼Œéœ€è¦è®¾ç½® <code>Authorization</code> çš„è¯·æ±‚å¤´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Authorization: Bearer &lt;token&gt;
</span></span></code></pre></td></tr></table></div></div><p>å›¾ä¾‹ï¼š</p><p><img class=lazyload src=/svg/loading.min.svg data-src=./jwt_authentication.png data-srcset="./jwt_authentication.png, ./jwt_authentication.png 1.5x, ./jwt_authentication.png 2x" data-sizes=auto alt=./jwt_authentication.png title=jwt_authentication></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ä¸º Token æ˜¯åœ¨è¯·æ±‚å¤´çš„ <code>Authorization</code> ä¸­å¸¦ä¸Šçš„ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šè¢«æµè§ˆå™¨çš„è·¨åŸŸç­–ç•¥ï¼ˆCORS, Cross-Origin Resource Sharingï¼‰å½±å“ã€‚<strong>Token ä¸æ˜¯ Cookie</strong>ã€‚</p><h3 id=ä¼˜ç‚¹ä¸ç¼ºç‚¹>ä¼˜ç‚¹ä¸ç¼ºç‚¹</h3><p>JWT(Json Web Token) ç›¸å¯¹ SWT(Simple Web Token) ä¸ SMAL(Security Assertion Markup Language Tokens) çš„å¥½å¤„ï¼š</p><ul><li>JWT ç›¸å¯¹äº SMAL æœ‰æ›´å°çš„ä½“ç§¯ï¼Œç›¸å¯¹äºè§£æ xml è§£æ json æ›´åŠ ç®€å•ï¼Œæ›´é€‚åˆåœ¨ http åè®®äº html æ–‡ä»¶çš„åœºæ™¯ä¸‹è¿›è¡Œä¼ è¾“ï¼›</li><li>JWT ç›¸å¯¹äº SWT æ›´åŠ å®‰å…¨ã€‚SWT åªèƒ½è§£æåŸºäºå…±äº«å¯†é’¥çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œè€Œ JWTï¼ˆSMAL ä¹Ÿæ”¯æŒï¼‰åˆ™æ”¯æŒ <code>X.509</code> æ ¼å¼çš„å…¬ç§é’¥ç­¾åï¼›</li></ul><p>ç›¸æ¯”ä¼ ç»Ÿä½¿ç”¨ <code>sessionID</code> çš„ cookie è¿›è¡Œèº«ä»½æ ¡éªŒçš„å¥½å¤„ï¼š</p><ol><li>Scalabilityï¼ˆå¯æ‰©å±•æ€§ï¼‰ï¼šä¼ ç»Ÿçš„ <code>sessionID</code> ç­–ç•¥å¦‚æœå°†ç”¨æˆ·ä¿¡æ¯æŒä¹…åŒ–å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œæ¯æ¬¡è¯·æ±‚æ•°æ®åº“éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡æ•°æ®åº“æŸ¥è¯¢ï¼›å¦‚æœå­˜å‚¨åœ¨å†…å­˜ä¸­åˆ™å­˜åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¨ªå‘æ‰©å±•é—®é¢˜ã€‚jwt å°†ä¿¡æ¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”æœåŠ¡ç«¯åšé‰´æƒï¼Œå°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼›</li><li>Multiple Devicesï¼šå¯ä»¥ç”¨äºè®¾è®¡ SSO å•ç‚¹ç™»å½•ç³»ç»Ÿï¼Œå› ä¸º JWT Token è¢«è®¾ç½®åœ¨ http è¯·æ±‚å¤´ä¸­ï¼Œå¯ä»¥è§„é¿æµè§ˆå™¨è·¨åŸŸé—®é¢˜ï¼›</li></ol><p>JWT ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œåœ¨ RFC çš„æ ‡å‡†åè®®ä¸­æ²¡æœ‰æŒ‡å®šè§£å†³æ–¹æ¡ˆï¼š</p><ul><li>å®¢æˆ·ç«¯å­˜å‚¨ä¿¡æ¯çš„å®‰å…¨æ€§ã€JWT ä¿¡æ¯ä¼ è¾“çš„å®‰å…¨æ€§ã€JWT Token éš¾ä»¥è¢«æ§åˆ¶å¤±æ•ˆã€å®¢æˆ·ç«¯ä¿¡æ¯ä¿¡ä»»é—®é¢˜ï¼›</li></ul><h3 id=nodejs-ç”Ÿæ€>nodejs ç”Ÿæ€</h3><p><a href=https://www.npmjs.com/package/jsonwebtoken target=_blank rel="noopener noreffer">jsonwebtoken</a> å¯ä»¥ç”¨äºåœ¨æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ª JWTï¼Œ<a href=https://github.com/auth0/express-jwt target=_blank rel="noopener noreffer">express-jwt</a> ä¸­é—´ä»¶å¯ä»¥ç”¨äºå¯¹ jwt è¿›è¡Œé‰´æƒã€‚</p><h2 id=oauth-open-authorization>OAuth (Open Authorization)</h2><p>OAuth æ˜¯ä¸€ç§ç¬¬ä¸‰æ–¹æˆæƒåè®®ï¼Œç°åœ¨è®¨è®ºçš„ç‰ˆæœ¬é€šå¸¸æ˜¯ OAuth2.0ï¼Œä¹Ÿæ˜¯ RFC çš„æ ‡å‡†åè®® <a href=https://datatracker.ietf.org/doc/html/rfc6749 target=_blank rel="noopener noreffer">RFC6749</a>ã€‚</p><p>OAuth çš„å¤§è‡´å·¥ä½œæµç¨‹åœ¨ RFC çš„æ–‡æ¡£ä¸­æœ‰è¯¦ç»†è§£é‡Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>     +--------+                               +---------------+
</span></span><span class=line><span class=cl>     |        |--(A)- Authorization Request -&gt;|   Resource    |
</span></span><span class=line><span class=cl>     |        |                               |     Owner     |
</span></span><span class=line><span class=cl>     |        |&lt;-(B)-- Authorization Grant ---|               |
</span></span><span class=line><span class=cl>     |        |                               +---------------+
</span></span><span class=line><span class=cl>     |        |
</span></span><span class=line><span class=cl>     |        |                               +---------------+
</span></span><span class=line><span class=cl>     |        |--(C)-- Authorization Grant --&gt;| Authorization |
</span></span><span class=line><span class=cl>     | Client |                               |     Server    |
</span></span><span class=line><span class=cl>     |        |&lt;-(D)----- Access Token -------|               |
</span></span><span class=line><span class=cl>     |        |                               +---------------+
</span></span><span class=line><span class=cl>     |        |
</span></span><span class=line><span class=cl>     |        |                               +---------------+
</span></span><span class=line><span class=cl>     |        |--(E)----- Access Token ------&gt;|    Resource   |
</span></span><span class=line><span class=cl>     |        |                               |     Server    |
</span></span><span class=line><span class=cl>     |        |&lt;-(F)--- Protected Resource ---|               |
</span></span><span class=line><span class=cl>     +--------+                               +---------------+
</span></span></code></pre></td></tr></table></div></div><p>åœ¨æ ‡å‡†æ–‡æ¡£æ›´å…³äºä¸åŒæˆæƒæ¨¡å¼çš„ä»‹ç»ï¼Œä¸è¯¦ç»†èµ˜è¿°ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ OAuth ä¸ JWT å¹¶ä¸æ˜¯å¹¶åˆ—çš„å…³ç³»ï¼ŒOAuth ä¸­çš„ Access Token å¯ä»¥ç”¨ JWT å®ç°ï¼Œå®ƒä»¬åº”è¯¥æ˜¯ä¸€ä¸ªåµŒå¥—çš„å…³ç³»ã€‚</p><h2 id=æœåŠ¡å‘ç°>æœåŠ¡å‘ç°</h2><blockquote><p><a href=https://zhuanlan.zhihu.com/p/161277955 target=_blank rel="noopener noreffer">https://zhuanlan.zhihu.com/p/161277955</a></p></blockquote><p>ä½¿ç”¨ä¸€ä¸ªåå­—æœåŠ¡å™¨è¿›è¡ŒæœåŠ¡å‘ç°ã€‚è§£å†³åˆ†å¸ƒå¼å¾®æœåŠ¡çš„ç½‘ç»œè°ƒç”¨ç»“æ„é—®é¢˜ã€‚</p><h2 id=æœåŠ¡é™æµ>æœåŠ¡é™æµ</h2><blockquote><p><a href=https://zhuanlan.zhihu.com/p/65900436 target=_blank rel="noopener noreffer">https://zhuanlan.zhihu.com/p/65900436</a></p></blockquote><p>æœåŠ¡é™æµç®—æ³•ï¼š</p><ul><li>è®¡æ•°å™¨ç®—æ³•ã€æ¼æ¡¶ç®—æ³•ã€ä»¤ç‰Œç®—æ³•</li></ul><h2 id=æœåŠ¡é›ªå´©é™çº§ç†”æ–­>æœåŠ¡é›ªå´©é™çº§ç†”æ–­</h2><p>æœåŠ¡é›ªå´©ï¼š</p><ul><li>ä¸€ä¸ªæœåŠ¡å¤±è´¥ï¼Œå¯¼è‡´æ•´æ¡é“¾è·¯çš„æœåŠ¡éƒ½å¤±è´¥çš„æƒ…å½¢ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæœåŠ¡é›ªå´©ã€‚</li></ul><p>æœåŠ¡ç†”æ–­ï¼š</p><ul><li>å½“ä¸‹æ¸¸çš„æœåŠ¡å› ä¸ºæŸç§åŸå› çªç„¶<strong>å˜å¾—ä¸å¯ç”¨</strong>æˆ–<strong>å“åº”è¿‡æ…¢</strong>ï¼Œä¸Šæ¸¸æœåŠ¡ä¸ºäº†ä¿è¯è‡ªå·±æ•´ä½“æœåŠ¡çš„å¯ç”¨æ€§ï¼Œä¸å†ç»§ç»­è°ƒç”¨ç›®æ ‡æœåŠ¡ï¼Œç›´æ¥è¿”å›ï¼Œå¿«é€Ÿé‡Šæ”¾èµ„æºã€‚</li></ul><p>æœåŠ¡é™çº§ï¼š</p><ul><li>å½“ä¸‹æ¸¸çš„æœåŠ¡å› ä¸ºæŸç§åŸå› <strong>å“åº”è¿‡æ…¢</strong>ï¼Œä¸‹æ¸¸æœåŠ¡ä¸»åŠ¨åœæ‰ä¸€äº›ä¸å¤ªé‡è¦çš„ä¸šåŠ¡ï¼Œé‡Šæ”¾å‡ºæœåŠ¡å™¨èµ„æºï¼Œå¢åŠ å“åº”é€Ÿåº¦ã€‚</li></ul><h2 id=ç‰ˆæœ¬æ§åˆ¶>ç‰ˆæœ¬æ§åˆ¶</h2><p>ç°åœ¨æµè¡Œçš„ç‰ˆæœ¬ç³»ç»Ÿä¸»è¦åˆ†ä¸ºé›†ä¸­å¼ç‰ˆæœ¬ç³»ç»Ÿã€åˆ†å¸ƒå¼ç‰ˆæœ¬ç³»ç»Ÿ 2 å¤§ç±»ã€‚</p><h3 id=é›†ä¸­å¼ç‰ˆæœ¬ç³»ç»Ÿ>é›†ä¸­å¼ç‰ˆæœ¬ç³»ç»Ÿ</h3><p>ä¸»è¦çš„é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼š</p><ul><li><code>CVS</code> (Concurrent Versions System) free softwareï¼Œä»¥ GNU ç‰ˆæƒå‘è¡Œï¼Œè®¸å¤šè€çš„ GNU é¡¹ç›®éƒ½ç”¨ CVSï¼Œ2008 å¹´åæ›´æ–°ä¸æ´»è·ƒã€‚</li><li><code>Subversion</code> (Apache Subversion) Apache Licenseï¼Œtop-level Apache projectï¼Œå…¼å®¹ CVSã€‚</li><li><code>SVN</code> åˆ™æ˜¯æœ€è‘—åçš„é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚</li></ul><p><code>SVN</code> çš„ä¸»è¦ç‰¹ç‚¹ï¼š</p><ul><li><p><code>SVN</code> éœ€è¦ä¸€ä¸ª<strong>ä¸­å¿ƒæœåŠ¡å™¨</strong>ï¼Œç”¨æ¥ä¿å­˜æ‰€æœ‰æ–‡ä»¶çš„æ‰€æœ‰ä¿®è®¢ç‰ˆæœ¬ã€‚</p></li><li><p>å®¢æˆ·ç«¯åªä¿å­˜æœ€æ–°çš„ç‰ˆæœ¬æˆ–è€…è®¾ç½®ä¸ºæ£€å‡ºæŸä¸€ä¸ªå†å²ç‰ˆæœ¬ï¼Œå®¢æˆ·ç«¯å¿…é¡»åœ¨è¿æ¥åˆ°ä¸­å¿ƒæœåŠ¡å™¨ä¹‹åæ‰èƒ½åšå‡ºæ£€å‡ºæŸä¸ªç‰ˆæœ¬ã€æŸ¥è¯¢æ–‡ä»¶ä¿®æ”¹å†å²ã€æäº¤æ›´æ–°ç­‰æ“ä½œã€‚</p></li><li><p>æ¯ä¸€æ¬¡ <code>commit</code> ä¹‹å‰ï¼Œéƒ½éœ€è¦è¿æ¥ä¸­å¿ƒæœåŠ¡å™¨è·å–æœ€æ–°çš„æ–‡ä»¶ç‰ˆæœ¬ï¼Œå¦‚æœä¸­å¿ƒæœåŠ¡å™¨å®•æœºï¼Œåˆ™ä½ æ— æ³•æäº¤ä»»ä½•æ›´æ–°ï¼Œä¹Ÿæ— æ³•å°†é¡¹ç›®å›æº¯åˆ°å†å²ç‰ˆæœ¬ã€‚</p></li><li><p>å¦‚æœä¸­å¿ƒæœåŠ¡å™¨å‘ç”Ÿç£ç›˜æ•…éšœï¼Œè€Œä½ åˆæ²¡æœ‰åšä»»ä½•å¤‡ä»½ï¼Œä½ å°†ä¼šä¸¢å¤±å½“å‰å’Œå†å²çš„æ‰€æœ‰æ•°æ®ã€‚</p></li><li><p>å¯¹ åˆ†æ”¯ çš„æ”¯æŒè¾ƒå¼±ï¼ŒSVN çš„åˆ†æ”¯å°±æ˜¯ä¸€ä¸ªå®Œæ•´ã€ç‹¬ç«‹çš„æ–‡ä»¶å¤¹ï¼Œåˆ†æ”¯çš„åˆ›å»ºå’Œåˆå¹¶ä»£ä»·éƒ½éå¸¸é«˜ï¼ˆå®é™…å¯èƒ½ä¼šé€šè¿‡ç¡¬è¿æ¥çš„æ–¹å¼èŠ‚çœç©ºé—´ï¼‰ï¼›</p></li><li><p>æ— æ³•è¿½è¸ªç›®å½•æ–‡ä»¶çš„å˜åŒ–ï¼Œå˜æ›´ç›®å½•éœ€è¦ä½¿ç”¨ SVN å‘½ä»¤ã€‚</p></li><li><p>ç®¡ç†å‘˜èƒ½å¤Ÿè½»æ¾æŒæ¡æ¯ä¸€ä¸ªå¼€å‘è€…çš„æƒé™ï¼ˆGit è‡ªèº«ä¸æ”¯æŒåˆ†æ”¯ä¿æŠ¤ï¼‰ã€‚</p></li></ul><h3 id=åˆ†å¸ƒå¼ç‰ˆæœ¬ç³»ç»Ÿ>åˆ†å¸ƒå¼ç‰ˆæœ¬ç³»ç»Ÿ</h3><p>ä¸»è¦çš„åˆ†å¸ƒå¼ç®¡ç†ç³»ç»Ÿï¼š</p><ul><li>Git ç¬¬ä¸€ä¸ªç‰ˆæœ¬ç”± Linus Torvalds ç¼–å†™ï¼ŒGNU GPL v2</li><li>Mercurial åŸºæœ¬ç”¨ python å®ç°ï¼Œç›®å‰ GNU GPL v2ã€‚ä»åœ¨ç”¨å®ƒç®¡ç†çš„<a href=https://www.mercurial-scm.org/wiki/ProjectsUsingMercurial target=_blank rel="noopener noreffer">é¡¹ç›®</a></li></ul><p>Git å’Œ Mercurial éƒ½æ˜¯ä¸ºäº†ç®¡ç† Linux kernel è€Œå¼€å‘çš„ï¼Œåªä¸è¿‡æœ€åç¤¾åŒºé€‰æ‹©äº† Gitã€‚</p><p>å¯¹äº Gitï¼Œä¸­å¿ƒæœåŠ¡å™¨æ˜¯å¯é€‰çš„ï¼Œå®¢æˆ·ç«¯ä¸ä»…ä»…æå–æœ€æ–°ç‰ˆæœ¬çš„æ–‡ä»¶å¿«ç…§ï¼Œè€Œæ˜¯æŠŠæ•´ä¸ªä»£ç ä»“åº“å®Œæ•´åœ°é•œåƒä¸‹æ¥ã€‚è¿™æ ·ä½ åœ¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­åšå‡ºä»»ä½•æäº¤ã€æ£€å‡ºï¼Œæ¯”è¾ƒç­‰æ“ä½œéƒ½æ˜¯åœ¨æœ¬åœ°è¿›è¡Œï¼Œå¦‚æœç”¨æ¥ååŒå·¥ä½œçš„ä¸­å¿ƒæœåŠ¡å™¨å‘ç”Ÿæ•…éšœï¼Œäº‹åå¯ä»¥ç”¨ä»»ä½•ä¸€ä¸ªé•œåƒæ¥æ¢å¤ä»£ç ä»“åº“ã€‚</p><h3 id=git-æ–‡ä»¶ç³»ç»Ÿ>Git æ–‡ä»¶ç³»ç»Ÿ</h3><p>æˆ‘ä»¬åœ¨ä¸€ä¸ª <code>git init</code> ç»“æœçš„ç©ºä»“åº“ä¸­ï¼Œç®€è¿°ä¸€ä¸‹å„ä¸ªéƒ¨åˆ†çš„ä½œç”¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.git
</span></span><span class=line><span class=cl>â”œâ”€â”€ HEAD 				// æŒ‡ç¤ºå½“å‰è¢«æ£€å‡ºçš„åˆ†æ”¯
</span></span><span class=line><span class=cl>â”œâ”€â”€ branches 		// åºŸå¼ƒ
</span></span><span class=line><span class=cl>â”œâ”€â”€ config 			// é¡¹ç›®å†…çš„é…ç½®æ–‡ä»¶
</span></span><span class=line><span class=cl>â”œâ”€â”€ description // ä¾›GitWebç¨‹åºä½¿ç”¨
</span></span><span class=line><span class=cl>â”œâ”€â”€ hooks 			// å­˜å‚¨é’©å­è„šæœ¬
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ applypatch-msg.sample
</span></span><span class=line><span class=cl>â”‚  ...
</span></span><span class=line><span class=cl>â”œâ”€â”€ info 				// ç›®å½•åŒ…å«ä¸€ä¸ªå…¨å±€æ€§æ’é™¤<span class=o>(</span>global exclude<span class=o>)</span>æ–‡ä»¶ï¼Œ
</span></span><span class=line><span class=cl>â”‚   â””â”€â”€ exclude	// ç”¨ä»¥æ”¾ç½®é‚£äº›ä¸å¸Œæœ›è¢«è®°å½•åœ¨ .gitignore æ–‡ä»¶ä¸­çš„å¿½ç•¥æ¨¡å¼<span class=o>(</span>ignored patterns<span class=o>)</span>
</span></span><span class=line><span class=cl>â”œâ”€â”€ objects 		// å­˜å‚¨æ‰€æœ‰æ•°æ®å†…å®¹
</span></span><span class=line><span class=cl>â”‚   â”œâ”€â”€ info 		// ä»“åº“çš„é¢å¤–ä¿¡æ¯
</span></span><span class=line><span class=cl>â”‚   â””â”€â”€ pack 		// å‹ç¼©åçš„åŒ…æ–‡ä»¶
</span></span><span class=line><span class=cl>â””â”€â”€ refs // å­˜å‚¨æŒ‡å‘åˆ†æ”¯çš„æäº¤å¯¹è±¡çš„æŒ‡é’ˆ
</span></span><span class=line><span class=cl>    â”œâ”€â”€ heads 	// åˆ†æ”¯
</span></span><span class=line><span class=cl>    â””â”€â”€ tags 		// æ ‡ç­¾
</span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Git ç›®å½•ç»“æ„è¯´æ˜ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git <span class=nb>help</span> gitrepository-layout
</span></span></code></pre></td></tr></table></div></div><p>å½“ Git å­˜å‚¨ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼š</p><ol><li>é¦–å…ˆä¼šæ ¹æ®æ–‡ä»¶å†…å®¹è®¡ç®—å‡ºæ–‡ä»¶çš„å“ˆå¸Œå€¼ (ä½¿ç”¨ SHA-1 ç®—æ³•)ï¼Œç»“æœæ˜¯ 40 ä½çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</li><li>å–å‰ 2 ä¸ªå­—ç¬¦ä½œä¸ºç›®å½•åï¼Œå 38 ä¸ªå­—ç¬¦ä½œä¸ºæ–‡ä»¶åï¼Œå­˜å‚¨åœ¨ <code>.git/objects</code> æ–‡ä»¶å¤¹ä¸‹ã€‚</li></ol><p>è¿™æ ·ç»™å®šæ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼Œå°±èƒ½åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ç›´æ¥å®šä½åˆ°æ–‡ä»¶ã€‚è¿™ç§è®¡ç®—æ–¹å¼éå¸ƒäº Git çš„å„ç§æ“ä½œä¸­ï¼ŒåŒ…æ‹¬åˆ†æ”¯ã€æäº¤è®°å½•ã€tag ç­‰éƒ½å¯ä»¥ç”¨å“ˆå¸Œå€¼æ¥è¡¨ç¤ºã€‚</p><p>ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹ï¼Œä¸€ä¸ªæŒ‡å®šå“ˆå¸Œå€¼ï¼Œå¯¹åº”çš„æ–‡ä»¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git cat-file -p &lt;hash&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=acid-ç†è®º>ACID ç†è®º</h2><p>å…³ç³»å‹æ•°æ®åº“æœ‰äº‹åŠ¡ï¼ˆtransactionï¼‰çš„æ¦‚å¿µï¼Œäº‹åŠ¡éµå¾ª ACID åŸåˆ™ï¼š</p><ul><li>A (Atomicity åŸå­æ€§)ï¼šäº‹åŠ¡é‡Œçš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨åšå®Œï¼Œè¦ä¹ˆéƒ½ä¸åšï¼Œäº‹åŠ¡æˆåŠŸçš„æ¡ä»¶æ˜¯äº‹åŠ¡é‡Œçš„æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸï¼Œåªè¦æœ‰ä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å°±å¤±è´¥ï¼Œéœ€è¦å›æ»šã€‚</li><li>C (Consistency ä¸€è‡´æ€§)ï¼š</li><li>I (Isolation ç‹¬ç«‹æ€§)ï¼š</li><li>D (Durability æŒä¹…æ€§)ï¼š</li></ul><h2 id=åˆ†å¸ƒå¼ç³»ç»Ÿ>åˆ†å¸ƒå¼ç³»ç»Ÿ</h2><p>ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Ÿ</p><ul><li>ç®€å•çš„æ¥è¯´ï¼Œ<strong>ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ä¸€ç»„è®¡ç®—æœºç³»ç»Ÿä¸€èµ·å·¥ä½œï¼Œåœ¨ç»ˆç«¯ç”¨æˆ·çœ‹æ¥ï¼Œå°±åƒä¸€å°è®¡ç®—æœºåœ¨å·¥ä½œä¸€æ ·</strong>ã€‚è¿™ç»„ä¸€èµ·å·¥ä½œçš„è®¡ç®—æœºï¼Œæ‹¥æœ‰<strong>å…±äº«çš„çŠ¶æ€</strong>ï¼Œä»–ä»¬åŒæ—¶è¿è¡Œï¼Œç‹¬ç«‹æœºå™¨çš„æ•…éšœä¸ä¼šå½±å“æ•´ä¸ªç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚</li></ul><p>åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¼˜ç‚¹ï¼š</p><ul><li><p>**å¯é æ€§ï¼ˆå®¹é”™ï¼‰ ï¼š**åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿä¸­çš„ä¸€ä¸ªé‡è¦çš„ä¼˜ç‚¹æ˜¯å¯é æ€§ã€‚ä¸€å°æœåŠ¡å™¨çš„ç³»ç»Ÿå´©æºƒå¹¶ä¸å½±å“åˆ°å…¶ä½™çš„æœåŠ¡å™¨ã€‚</p></li><li><p>**å¯æ‰©å±•æ€§ï¼š**åœ¨åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿå¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æ›´å¤šçš„æœºå™¨ã€‚</p></li><li><p>**èµ„æºå…±äº«ï¼š**å…±äº«æ•°æ®æ˜¯å¿…ä¸å¯å°‘çš„åº”ç”¨ï¼Œå¦‚é“¶è¡Œï¼Œé¢„è®¢ç³»ç»Ÿã€‚</p></li><li><p>**çµæ´»æ€§ï¼š**ç”±äºè¯¥ç³»ç»Ÿæ˜¯éå¸¸çµæ´»çš„ï¼Œå®ƒå¾ˆå®¹æ˜“å®‰è£…ï¼Œå®æ–½å’Œè°ƒè¯•æ–°çš„æœåŠ¡ã€‚</p></li><li><p>**æ›´å¿«çš„é€Ÿåº¦ï¼š**åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿå¯ä»¥æœ‰å¤šå°è®¡ç®—æœºçš„è®¡ç®—èƒ½åŠ›ï¼Œä½¿å¾—å®ƒæ¯”å…¶ä»–ç³»ç»Ÿæœ‰æ›´å¿«çš„å¤„ç†é€Ÿåº¦ã€‚</p></li><li><p>**å¼€æ”¾ç³»ç»Ÿï¼š**ç”±äºå®ƒæ˜¯å¼€æ”¾çš„ç³»ç»Ÿï¼Œæœ¬åœ°æˆ–è€…è¿œç¨‹éƒ½å¯ä»¥è®¿é—®åˆ°è¯¥æœåŠ¡ã€‚</p></li><li><p>**æ›´é«˜çš„æ€§èƒ½ï¼š**ç›¸è¾ƒäºé›†ä¸­å¼è®¡ç®—æœºç½‘ç»œé›†ç¾¤å¯ä»¥æä¾›æ›´é«˜çš„æ€§èƒ½ï¼ˆåŠæ›´å¥½çš„æ€§ä»·æ¯”ï¼‰ã€‚</p></li></ul><p>åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç¼ºç‚¹ï¼š</p><ul><li><p>**æ•…éšœæ’é™¤ï¼š**æ•…éšœæ’é™¤å’Œè¯Šæ–­é—®é¢˜ã€‚</p></li><li><p>**è½¯ä»¶ï¼š**æ›´å°‘çš„è½¯ä»¶æ”¯æŒæ˜¯åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿçš„ä¸»è¦ç¼ºç‚¹ã€‚</p></li><li><p>**ç½‘ç»œï¼š**ç½‘ç»œåŸºç¡€è®¾æ–½çš„é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼šä¼ è¾“é—®é¢˜ï¼Œé«˜è´Ÿè½½ï¼Œä¿¡æ¯ä¸¢å¤±ç­‰ã€‚</p></li><li><p>**å®‰å…¨æ€§ï¼š**å¼€æ”¾ç³»ç»Ÿçš„ç‰¹æ€§è®©åˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿå­˜åœ¨ç€æ•°æ®çš„å®‰å…¨æ€§å’Œå…±äº«çš„é£é™©ç­‰é—®é¢˜ã€‚</p></li></ul><h2 id=cap-ç†è®º>CAP ç†è®º</h2><p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­, CAPå®šç†ï¼ˆCAP theoremï¼‰, åˆè¢«ç§°ä½œ å¸ƒé²å°”å®šç†ï¼ˆBrewer&rsquo;s theoremï¼‰, å®ƒæŒ‡å‡ºå¯¹äºä¸€ä¸ªåˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿæ¥è¯´ï¼Œä¸å¯èƒ½åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸‰ç‚¹:</p><ul><li>ä¸€è‡´æ€§(Consistency)ï¼šæ‰€æœ‰èŠ‚ç‚¹åœ¨åŒä¸€æ—¶é—´å…·æœ‰ç›¸åŒçš„æ•°æ®ï¼›</li><li>å¯ç”¨æ€§(Availability)ï¼šä¿è¯æ¯ä¸ªè¯·æ±‚ä¸ç®¡æˆåŠŸæˆ–è€…å¤±è´¥éƒ½æœ‰å“åº”ï¼›</li><li>åˆ†éš”å®¹å¿(Partition tolerance)ï¼šç³»ç»Ÿä¸­ä»»æ„ä¿¡æ¯çš„ä¸¢å¤±æˆ–å¤±è´¥ä¸ä¼šå½±å“ç³»ç»Ÿçš„ç»§ç»­è¿ä½œï¼›</li></ul><p>å› ä¸ºä¸‰è€…æ— æ³•åŒæ—¶æ»¡è¶³ï¼Œæ‰€ä»¥åˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥è¢«åˆ†ä¸º CAã€CPã€AP ä¸‰å¤§ç±»ï¼Œå› ä¸º CA ç³»ç»Ÿæœ¬è´¨åªæ˜¯å•ç‚¹é›†ç¾¤ï¼Œæ‰€ä»¥æ— æ³•æ»¡è¶³ P çš„ç³»ç»Ÿåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸åªè®¨è®º AP æˆ– CP ç³»ç»Ÿã€‚</p><h2 id=base-ç†è®º>BASE ç†è®º</h2><p>BASEï¼šBasically Available, Soft-state, Eventually Consistentã€‚ ç”± Eric Brewer å®šä¹‰ã€‚</p><p>ç›¸å¯¹äº CAP ç†è®ºï¼ŒBASE ç†è®ºåˆ™å¼ºè°ƒå¯ç”¨æ€§è¶…è¿‡ä¸€è‡´æ€§ï¼Œé€šå¸¸ç”¨äºæè¿° NoSQL æ•°æ®åº“çš„ç‰¹æ€§ã€‚</p><ul><li>Basically Availableï¼šåŸºæœ¬å¯ç”¨</li><li>Soft-Stateï¼šè½¯çŠ¶æ€/æŸ”æ€§äº‹åŠ¡ã€‚å³åœ¨æ²¡æœ‰ä»»ä½•è¾“å…¥çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ä¹Ÿä¼šå‘ç”Ÿå˜æ›´ã€‚</li><li>Eventually Consistencyï¼šæœ€ç»ˆä¸€è‡´æ€§ã€‚ç³»ç»Ÿä¼šéšç€æ—¶é—´çš„å˜åŒ–æœ€ç»ˆè¾¾åˆ°ä¸€è‡´æ€§çš„è¦æ±‚ã€‚</li></ul><h2 id=roaring-bitmap>Roaring Bitmap</h2><h3 id=èƒŒæ™¯>èƒŒæ™¯</h3><p>å®˜ç½‘ï¼šhttp://roaringbitmap.org/</p><p>å¼€æºä»£ç ï¼šhttps://github.com/RoaringBitmap/RoaringBitmap</p><p>è®ºæ–‡ï¼š</p><ul><li>ã€ŠBetter bitmap performance with Roaring bitmapsã€‹ï¼šhttps://arxiv.org/abs/1402.6407ï¼Œhttps://arxiv.org/pdf/1402.6407.pdf</li><li>ã€ŠConsistently faster and smaller compressed bitmaps with Roaringã€‹ï¼šhttps://arxiv.org/abs/1603.06549ï¼Œhttps://arxiv.org/pdf/1603.06549.pdf</li></ul><p>ç›¸å…³æ–‡ç« ï¼šhttps://cloud.tencent.com/developer/article/1136054</p><h3 id=ç«å“è§£å†³æ–¹æ¡ˆ>ç«å“è§£å†³æ–¹æ¡ˆ</h3><p>Roaring Bitmap æ˜¯å¯¹ Bitmap çš„ä¼˜åŒ–ï¼Œæ˜¯â€œå‹ç¼©ä½å›¾ç´¢å¼•â€çš„ä¸€ç§ï¼ŒåŒæ ·çš„æ–¹æ¡ˆè¿˜æœ‰ï¼š</p><ul><li>RLEï¼ˆRun-Length Encodingï¼‰ï¼›</li><li>WAH (Word Aligned Hybrid Compression Scheme) ï¼›</li><li>Concise (Compressed â€˜nâ€™ Composable Integer Set)</li></ul><h3 id=ç©ºé—´å¤æ‚åº¦åˆ†æ>ç©ºé—´å¤æ‚åº¦åˆ†æ</h3><p>å‡è®¾æˆ‘ä»¬çš„ç³»ç»Ÿä¸»çº¿æ˜¯ 64 ä½ï¼Œæˆ‘ä»¬éœ€è¦å­˜å‚¨ç±»å‹ä¸º <code>uint32_t</code> çš„ç´¢å¼•åˆ°ä¸€ä¸ªå¯¹è±¡åœ°å€ã€‚</p><p>ä¼ ç»Ÿçš„ Bitmap å¯¹åº”çš„ç©ºé—´å¤æ‚åº¦ä¸ºï¼š</p><ul><li>$2^{32} * 64 bit = 4G * 8byte = 32 GByte$ï¼Œæ˜¯ä¸€ä¸ªä¸è®ºæ•°æ®åˆ†å¸ƒå¦‚ä½•çš„å¸¸æ•°ã€‚</li></ul><p>è€Œ Roaring Bitmap å¯¹åº”çš„ç©ºé—´å¤æ‚åº¦ä¸ºï¼š</p><ul><li><p>ä¸€çº§ç´¢å¼•çš„å†…å®¹æ˜¯äºŒçº§ç´¢å¼•çš„åœ°å€æŒ‡é’ˆï¼š$2^{16} * 64bit = 2^{22} = 512KByte$</p></li><li><p>è€ŒäºŒçº§ç´¢å¼•æ˜¯ä¸€ä¸ªéšæ•°æ®åˆ†å¸ƒè€Œå˜åŒ–çš„é‡ï¼š</p><ul><li>ç©ºæ ‡è®°ä½ 0Byteï¼Œåªéœ€è¦æ ‡è®°å­˜å‚¨åœ°å€çš„æŒ‡é’ˆï¼›</li><li>åœ¨æ•°æ®ç¨€ç–æ—¶é€šè¿‡æ•°ç»„å­˜å‚¨å¯¹åº”çš„æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®éœ€è¦å­˜å‚¨å‰©ä½™çš„ä½ 16 ä½ç´¢å¼•ä»¥åŠæ•°æ®æœ¬èº«ï¼Œå¯¹äºä¸€ä¸ªæ¡¶ä¸­æœ‰ n ä¸ªæ•°æ®ï¼š$n * (2^{16} + 2^{64})$</li><li>å¯¹äºç¨ å¯†çš„æ•°æ®ï¼Œå°†é€šè¿‡ bitmap å­˜å‚¨è¯¥æ¡¶ä¸­çš„æ•°æ®ï¼Œç©ºé—´é€€åŒ–ä¸ºå¸¸æ•° $2^{16} * 2^{64}$ï¼Œè¿™ä¸»è¦æ˜¯å‡ºäºæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦çš„è€ƒè™‘è€Œéç©ºé—´çš„è€ƒè™‘ã€‚</li></ul></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>æ›´æ–°äº 2018-12-30</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="åˆ†äº«åˆ° Twitter" data-sharer=twitter data-url=http://shesl-meow.github.io/posts/%E6%A6%82%E5%BF%B5%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%A2%E8%AF%95%E9%A2%98/ data-title=:ambulance:æ¦‚å¿µå­¦ä¹ ä¸é¢è¯•é¢˜ data-hashtags=æŒç»­æ›´æ–°,ç®—æ³•,æœåŠ¡ç«¯><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° Facebook" data-sharer=facebook data-url=http://shesl-meow.github.io/posts/%E6%A6%82%E5%BF%B5%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%A2%E8%AF%95%E9%A2%98/ data-hashtag=æŒç»­æ›´æ–°><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° å¾®åš" data-sharer=weibo data-url=http://shesl-meow.github.io/posts/%E6%A6%82%E5%BF%B5%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%A2%E8%AF%95%E9%A2%98/ data-title=:ambulance:æ¦‚å¿µå­¦ä¹ ä¸é¢è¯•é¢˜ data-ralateuid=3968720593><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/>æŒç»­æ›´æ–°</a>,&nbsp;<a href=/tags/%E7%AE%97%E6%B3%95/>ç®—æ³•</a>,&nbsp;<a href=/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/>æœåŠ¡ç«¯</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>è¿”å›</a></span>&nbsp;|&nbsp;<span><a href=/>ä¸»é¡µ</a></span></section></div><div class=post-nav><a href=/posts/linux-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/ class=prev rel=prev title=":hammer:Linux å¸¸ç”¨å‘½ä»¤æ‰‹å†Œ"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>ğŸ”¨Linux å¸¸ç”¨å‘½ä»¤æ‰‹å†Œ</a>
<a href=/posts/%E5%A0%86%E5%8C%BA%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/ class=next rel=next title=:truck:å †åŒºå¦‚ä½•è¿›è¡Œå†…å­˜åˆ†é…>ğŸššå †åŒºå¦‚ä½•è¿›è¡Œå†…å­˜åˆ†é…<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://shesl-meow.github.io target=_blank>ä½˜å´§æ—</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=å›åˆ°é¡¶éƒ¨><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=æŸ¥çœ‹è¯„è®º><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/valine@1.5.0/dist/Valine.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.8127f0ca4cabc7246f3620f3ef3bf9b1db02805dfe03d6d4c57bc74bc0bf6eea.js integrity="sha256-gSfwykyrxyRvNiDz7zv5sdsCgF3+A9bUxXvHS8C/buo="></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.825fab54c26891370cbd3df4cdff5c9de31af8bb84474e6774573463d8708ae7.js integrity="sha256-gl+rVMJokTcMvT30zf9cneMa+LuER05ndFc0Y9hwiuc="></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"å¤åˆ¶åˆ°å‰ªè´´æ¿",maxShownLines:50},comment:{valine:{appId:"zDVJohJIQbD6f3W267xtaYRC-gzGzoHsz",appKey:"ewsfU9ocNOeuvt0MzONe6yKx",avatar:"mp",el:"#valine",emojiCDN:"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/",emojiMaps:{100:"1f4af.png",alien:"1f47d.png",anger:"1f4a2.png",angry:"1f620.png",anguished:"1f627.png",astonished:"1f632.png",black_heart:"1f5a4.png",blue_heart:"1f499.png",blush:"1f60a.png",bomb:"1f4a3.png",boom:"1f4a5.png",broken_heart:"1f494.png",brown_heart:"1f90e.png",clown_face:"1f921.png",cold_face:"1f976.png",cold_sweat:"1f630.png",confounded:"1f616.png",confused:"1f615.png",cry:"1f622.png",crying_cat_face:"1f63f.png",cupid:"1f498.png",dash:"1f4a8.png",disappointed:"1f61e.png",disappointed_relieved:"1f625.png",dizzy:"1f4ab.png",dizzy_face:"1f635.png",drooling_face:"1f924.png",exploding_head:"1f92f.png",expressionless:"1f611.png",face_vomiting:"1f92e.png",face_with_cowboy_hat:"1f920.png",face_with_hand_over_mouth:"1f92d.png",face_with_head_bandage:"1f915.png",face_with_monocle:"1f9d0.png",face_with_raised_eyebrow:"1f928.png",face_with_rolling_eyes:"1f644.png",face_with_symbols_on_mouth:"1f92c.png",face_with_thermometer:"1f912.png",fearful:"1f628.png",flushed:"1f633.png",frowning:"1f626.png",ghost:"1f47b.png",gift_heart:"1f49d.png",green_heart:"1f49a.png",grimacing:"1f62c.png",grin:"1f601.png",grinning:"1f600.png",hankey:"1f4a9.png",hear_no_evil:"1f649.png",heart:"2764-fe0f.png",heart_decoration:"1f49f.png",heart_eyes:"1f60d.png",heart_eyes_cat:"1f63b.png",heartbeat:"1f493.png",heartpulse:"1f497.png",heavy_heart_exclamation_mark_ornament:"2763-fe0f.png",hole:"1f573-fe0f.png",hot_face:"1f975.png",hugging_face:"1f917.png",hushed:"1f62f.png",imp:"1f47f.png",innocent:"1f607.png",japanese_goblin:"1f47a.png",japanese_ogre:"1f479.png",joy:"1f602.png",joy_cat:"1f639.png",kiss:"1f48b.png",kissing:"1f617.png",kissing_cat:"1f63d.png",kissing_closed_eyes:"1f61a.png",kissing_heart:"1f618.png",kissing_smiling_eyes:"1f619.png",laughing:"1f606.png",left_speech_bubble:"1f5e8-fe0f.png",love_letter:"1f48c.png",lying_face:"1f925.png",mask:"1f637.png",money_mouth_face:"1f911.png",nauseated_face:"1f922.png",nerd_face:"1f913.png",neutral_face:"1f610.png",no_mouth:"1f636.png",open_mouth:"1f62e.png",orange_heart:"1f9e1.png",partying_face:"1f973.png",pensive:"1f614.png",persevere:"1f623.png",pleading_face:"1f97a.png",pouting_cat:"1f63e.png",purple_heart:"1f49c.png",rage:"1f621.png",relaxed:"263a-fe0f.png",relieved:"1f60c.png",revolving_hearts:"1f49e.png",right_anger_bubble:"1f5ef-fe0f.png",robot_face:"1f916.png",rolling_on_the_floor_laughing:"1f923.png",scream:"1f631.png",scream_cat:"1f640.png",see_no_evil:"1f648.png",shushing_face:"1f92b.png",skull:"1f480.png",skull_and_crossbones:"2620-fe0f.png",sleeping:"1f634.png",sleepy:"1f62a.png",slightly_frowning_face:"1f641.png",slightly_smiling_face:"1f642.png",smile:"1f604.png",smile_cat:"1f638.png",smiley:"1f603.png",smiley_cat:"1f63a.png",smiling_face_with_3_hearts:"1f970.png",smiling_imp:"1f608.png",smirk:"1f60f.png",smirk_cat:"1f63c.png",sneezing_face:"1f927.png",sob:"1f62d.png",space_invader:"1f47e.png",sparkling_heart:"1f496.png",speak_no_evil:"1f64a.png",speech_balloon:"1f4ac.png","star-struck":"1f929.png",stuck_out_tongue:"1f61b.png",stuck_out_tongue_closed_eyes:"1f61d.png",stuck_out_tongue_winking_eye:"1f61c.png",sunglasses:"1f60e.png",sweat:"1f613.png",sweat_drops:"1f4a6.png",sweat_smile:"1f605.png",thinking_face:"1f914.png",thought_balloon:"1f4ad.png",tired_face:"1f62b.png",triumph:"1f624.png",two_hearts:"1f495.png",unamused:"1f612.png",upside_down_face:"1f643.png",weary:"1f629.png",white_frowning_face:"2639-fe0f.png",white_heart:"1f90d.png",wink:"1f609.png",woozy_face:"1f974.png",worried:"1f61f.png",yawning_face:"1f971.png",yellow_heart:"1f49b.png",yum:"1f60b.png",zany_face:"1f92a.png",zipper_mouth_face:"1f910.png",zzz:"1f4a4.png"},enableQQ:!1,highlight:!0,lang:"zh-CN",pageSize:10,placeholder:"ä½ çš„è¯„è®º ...",recordIP:!0,serverURLs:"https://zdvjohji.lc-cn-n1-shared.com",visitor:!0}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"æ²¡æœ‰æ‰¾åˆ°ç»“æœ",snippetLength:30}}</script><script type=text/javascript src=/js/theme.min.d7121d72cd85153ec9d35a888cee3eb28c2700ca763f649a538f6c772d750021.js integrity="sha256-1xIdcs2FFT7J01qIjO4+sownAMp2P2SaU49sdy11ACE="></script></body></html>